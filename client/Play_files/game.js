var l=true,o=null,p=false;function F(){return function(){}}function M(a){return function(){return this[a]}}function N(a){return function(){return a}}(function(){function dA(n,g,z,y){var x,w;this.cells=Array(n);for(var u=0;u<n;++u){this.cells[u]=Array(g);for(var r=0;r<g;++r){this.cells[u][r]=new dn(u,r,dm)}}this.width=n;this.height=g;this.Ad=z;this.ma=(x=new cV(0.5,0.5),w=new cV(0,0),w.x=z.x+x.x,w.y=z.y+x.y,w);this.Rc=(x=new cV(0.5,0.5),w=new cV(0,0),w.x=y.x+x.x,w.y=y.y+x.y,w)}function cE(n,g,w,u,r){n.fillRect(g,w,u,r);n.strokeRect(g,w,u,r)}function dn(n,g,r){this.x=n;this.y=g;this.type=r;this.s=[]}function dE(n,g,r){this.C=new dp(n,g);this.color=r}function dk(){this.j=new dA(50,50,new cV(0.5,0.5),new cV(0.5,0.5));this.i=new dq(this.j.ma,bZ);this.r=new dq(this.j.ma,bB);this.kc=0;this.Dd=new cV(0,0);this.S=[];this.Ga=[];this.$=0;this.killKey=p;this.Wa=0;this.ca=dN;this.O=[0,0,0,0]}function cJ(n,g){var w,u,r;this.m=new cV(Math.min(n.x,g.x),Math.min(n.y,g.y));this.size=(w=new cV(Math.max(n.x,g.x),Math.max(n.y,g.y)),u=this.m,r=new cV(0,0),r.x=w.x-u.x,r.y=w.y-u.y,r)}function dy(){arguments=Array.prototype.slice.call(arguments);this.f=arguments.shift();this.v=arguments;this.Na=[];for(var g=0;g<this.v.length;g++){this.Na.push(new dp(this.v[g],this.v[(g+1)%this.v.length]))}this.Sb=new cJ(this.v[0],this.v[0]);this.Uc()}function cN(){}function cm(n,g,r){this.Ba=r;this.Re=n;this.q=g}function b0(){this.nd();this.ic=[0,0,0,0]}function dp(n,g){var y,x,w,u,r;this.start=n;this.end=g;this.q=(y=(w=(r=new cV(0,0),r.x=g.x-n.x,r.y=g.y-n.y,r),u=w.x,w.x=w.y,w.y=-u,w),x=Math.sqrt(y.x*y.x+y.y*y.y),y.x/=x,y.y/=x,y)}function dx(n,g){this.f=n;this.h=g}function dv(){this.b=new cV(0,0);this.l=p}function c5(n,g){return typeof g!=="undefined"?n+(g-n)*Math.random():n}function bD(n,g,u,r){return"rgba("+Math.round(n*255)+", "+Math.round(g*255)+", "+Math.round(u*255)+", "+r+")"}function dD(){}function c0(g){g="background-cache-"+g;this.canvas=document.getElementById(g);if(this.canvas===o){this.canvas=document.createElement("canvas");this.canvas.id=g;this.canvas.style.display="none";document.body.appendChild(this.canvas)}this.oa=this.canvas.getContext("2d");this.Ob=this.Nb=this.vb=this.ub=0;this.Wa=-1}function ez(n,g,u,r){this.i=n;this.r=g;this.width=u;this.height=r;if(eh){this.Rb=new c0("a");this.uc=new c0("b")}else{this.uc=this.Rb=o}}function dP(n,g,x,w){var u=x/w.y,r=g/w.x;n.beginPath();-g*w.y- -x*w.x>=0&&n.lineTo(-g,-x);Math.abs(w.y*r)<=x&&n.lineTo(-w.x*r,-w.y*r);-g*w.y-+x*w.x>=0&&n.lineTo(-g,+x);Math.abs(w.x*u)<=g&&n.lineTo(w.x*u,w.y*u);+g*w.y-+x*w.x>=0&&n.lineTo(+g,+x);Math.abs(w.y*r)<=x&&n.lineTo(w.x*r,w.y*r);+g*w.y- -x*w.x>=0&&n.lineTo(+g,-x);Math.abs(w.x*u)<=g&&n.lineTo(-w.x*u,-w.y*u);n.closePath();n.clip()}function cB(n){this.Fc=username;this.O=[];if(this.Fc!==o){var g=this;$.ajax({url:"/stats/",type:"GET",cache:p,dataType:"json",success:function(r){g.O=r;n()}})}else{this.O=JSON.parse(dh("rapt")||"[]");n()}}function dh(n){n=n+"=";for(var g=document.cookie.split(";"),u=0;u<g.length;u++){for(var r=g[u];r.charAt(0)==" ";){r=r.substring(1,r.length)}if(r.indexOf(n)==0){return unescape(r.substring(n.length,r.length))}}return o}function b5(n,g,r){if(g-n>Math.PI){n+=2*Math.PI}else{if(n-g>Math.PI){n-=2*Math.PI}}g=g-n;if(Math.abs(g)>r){g=g>0?r:-r}n+=g;n-=Math.floor(n/(2*Math.PI))*2*Math.PI;return n}function cM(g){return g.toLowerCase().replace(/^(.)|\s(.)/g,function(n){return n.toUpperCase()})}function es(g){return g.color===1?cQ.i:cQ.r}function cG(g){return new cV(g[0],g[1])}function cp(n){var g=cG(n.pos);switch(n.type){case"bomber":return new cn(g,n.angle);case"bouncy rocket launcher":return new d0(g,es(n));case"corrosion cloud":return new bQ(g,es(n));case"doom magnet":return new bt(g);case"grenadier":return new bi(g,es(n));case"jet stream":return new aX(g,n.angle);case"headache":return new b1(g,es(n));case"hunter":return new bE(g);case"multi gun":return new a7(g);case"popper":return new aP(g);case"rocket spider":return new d5(g,n.angle);case"shock hawk":return new ax(g,es(n));case"spike ball":return new T(g);case"stalacbat":return new aG(g,es(n));case"wall avoider":return new ey(g,es(n));case"wall crawler":return new bI(g,n.angle);case"wheeligator":return new am(g,n.angle);default:console.log("Invalid enemy type in level");return new T(g)}}function eg(n,g,u,r){this.cells=[u,r];this.s=[n,g]}function cK(n,g){dv.prototype.constructor.call(this);this.type=n;this.I=g}function ds(n,g,y,x,w,u,r){cK.prototype.constructor.call(this,n,w);this.Cd=u;this.tb=r;this.M=cJ.fc(g,y,x)}function cn(n,g){ds.prototype.constructor.call(this,b3,n,bG,bk,dF,c3,0+(c3-0)*Math.random());if(g<Math.PI*0.25){this.la(new cV(dL,0))}else{if(g<Math.PI*0.75){this.la(new cV(0,dL))}else{if(g<Math.PI*1.25){this.la(new cV(-dL,0))}else{g<Math.PI*1.75?this.la(new cV(0,-dL)):this.la(new cV(dL,0))}}}}function d0(n,g){ds.prototype.constructor.call(this,d2,n,dt,cS,0,ct,0);this.target=g;this.Tb=l;this.k=0;this.o=new cF;this.o.p=this.target===cQ.i?function(r){r.strokeStyle="black";r.beginPath();r.moveTo(0,-0.1);r.lineTo(-0.3,-0.1);r.lineTo(-0.3,0.1);r.lineTo(0,0.1);r.stroke();r.fillStyle="red";r.beginPath();r.arc(0,0,0.2,0,2*Math.PI,p);r.fill();r.fillStyle="blue";r.beginPath();r.arc(0,0,0.2,1.65*Math.PI,2.35*Math.PI,p);r.fill();r.strokeStyle="black";r.beginPath();r.arc(0,0,0.2,0,2*Math.PI,p);r.stroke();r.beginPath();r.moveTo(0.1,-0.18);r.lineTo(0.1,0.18);r.stroke()}:function(r){r.strokeStyle="black";r.beginPath();r.moveTo(0,-0.1);r.lineTo(-0.3,-0.1);r.lineTo(-0.3,0.1);r.lineTo(0,0.1);r.stroke();r.fillStyle="blue";r.beginPath();r.arc(0,0,0.2,0,2*Math.PI,p);r.fill();r.fillStyle="red";r.beginPath();r.arc(0,0,0.2,1.65*Math.PI,2.35*Math.PI,p);r.fill();r.strokeStyle="black";r.beginPath();r.arc(0,0,0.2,0,2*Math.PI,p);r.stroke();r.fillStyle="black";r.beginPath();r.moveTo(0.1,-0.18);r.lineTo(0.1,0.18);r.stroke()}}function a7(n){var g,u,r;ds.prototype.constructor.call(this,b7,n,bO,br,0,a5,0);this.Fa=this.Ca=o;this.ac=Array(4);this.g=Array(4);n=this.a();this.Ca=new cV(n.x,n.y);this.Fa=new cV(n.x,n.y);this.g[0]=this.M.m;this.g[1]=new cV(this.M.eb(),this.M.m.y);this.g[2]=new cV(this.M.m.x,this.M.gb());this.g[3]=(g=this.M.m,u=new cV(this.M.$b(),this.M.Pc()),r=new cV(0,0),r.x=g.x+u.x,r.y=g.y+u.y,r)}function bi(n,g){ds.prototype.constructor.call(this,aO,n,av,v,0,cC,0+(cC-0)*Math.random());this.target=g;this.rb=this.wa=0;this.o=new cF;this.o.p=function(r){r.beginPath();r.moveTo(-0.25,-0.25);r.lineTo(-0.175,-0.25);r.lineTo(-0.175,-0.02);r.lineTo(0,0.175);r.lineTo(0.175,-0.02);r.lineTo(0.175,-0.25);r.lineTo(0.25,-0.25);r.lineTo(0.25,0);r.lineTo(0,0.27);r.lineTo(-0.25,0);r.closePath();r.fill();r.stroke()}}function dz(n,g,u,r){cK.prototype.constructor.call(this,n,r);this.N=new dx(g,u)}function bI(n,g){dz.prototype.constructor.call(this,ex,n,aY,0);this.Lc=l;this.yb=p;this.b=new cV(Math.cos(g),Math.sin(g));this.o=new cF;this.o.p=function(r){r.fillStyle="black";r.strokeStyle="black";r.beginPath();r.arc(0,0,0.25,Math.PI*0.25+0.15,Math.PI*0.75-0.15,p);r.stroke();r.beginPath();r.arc(0,0,0.25,Math.PI*0.75+0.15,Math.PI*1.25-0.15,p);r.stroke();r.beginPath();r.arc(0,0,0.25,Math.PI*1.25+0.15,Math.PI*1.75-0.15,p);r.stroke();r.beginPath();r.arc(0,0,0.25,Math.PI*1.75+0.15,Math.PI*2.25-0.15,p);r.stroke();r.beginPath();r.arc(0,0,0.15,0,2*Math.PI,p);r.stroke();r.beginPath();r.moveTo(0.15,0);r.lineTo(0.25,0);r.moveTo(0,0.15);r.lineTo(0,0.25);r.moveTo(-0.15,0);r.lineTo(-0.25,0);r.moveTo(0,-0.15);r.lineTo(0,-0.25);r.stroke();r.beginPath();r.arc(0,0,0.05,0,2*Math.PI,p);r.fill()}}function am(n,g){dz.prototype.constructor.call(this,ef,n,dO,dM);this.Sc=p;this.ga=0;this.Ie=Math.cos(g)>0;this.o=new cF;this.o.p=function(x){x.strokeStyle="black";x.beginPath();x.arc(0,0,dO,0,2*Math.PI,p);x.arc(0,0,dO-0.1,Math.PI,3*Math.PI,p);x.stroke();x.fillStyle="black";for(var w=0;w<4;w++){var u=w*(2*Math.PI/4),r=u+Math.PI/4;x.beginPath();x.arc(0,0,dO,u,r,p);x.arc(0,0,dO-0.1,r,u,l);x.fill()}}}function c2(g){cK.prototype.constructor.call(this,-1,0);this.N=new dx(g,cl);this.$=0;cQ.ra(ck)}function bl(n,g,u){var r;cK.prototype.constructor.call(this,c1,1);this.M=cJ.fc(n,cA,cj);this.qb=1;this.Ce=(r=2*Math.PI,0+(r-0)*Math.random());this.Ld=g;this.Qe=u;this.oc=this.Fd=p;this.Ga=[]}function aZ(n,g,r){cK.prototype.constructor.call(this,bX,0);this.M=cJ.fc(n,bA,bh);this.Mb=o;this.text=g;this.Wb=p;this.$=0;this.Je=r===undefined?aU:r}function aX(n,g){ds.prototype.constructor.call(this,aE,n,ak,h,0,bY,0);this.direction=g;this.Hb=0;this.d=[new cF,new cF];this.d[aH].p=this.d[d4].p=function(w){w.strokeStyle="black";w.beginPath();for(var u=0;u<c8;u++){var r=u*(2*Math.PI/c8);w.moveTo(0,0);w.lineTo(0.2*Math.cos(r),0.2*Math.sin(r))}w.stroke()}}function j(n,g,u,r){cK.prototype.constructor.call(this,n,r);this.N=new dx(g,u)}function ax(n,g){j.prototype.constructor.call(this,eo,n,dW,0);this.target=g;this.xb=p;this.o=new cF;this.o.p=function(u){u.beginPath();u.moveTo(0,-0.15);u.lineTo(0.05,-0.1);u.lineTo(0,0.1);u.lineTo(-0.05,-0.1);u.fill();u.beginPath();for(var r=-1;r<=1;r+=2){u.moveTo(0,-0.3);u.lineTo(r*0.05,-0.2);u.lineTo(r*0.1,-0.225);u.lineTo(r*0.1,-0.275);u.lineTo(r*0.15,-0.175);u.lineTo(0,0.3);u.moveTo(0,-0.15);u.lineTo(r*0.05,-0.1);u.lineTo(0,0.1)}u.stroke()}}function bW(g){this.Ma=[];this.za=new cV(g.x*cH,g.y*cH);this.za.x+=(Math.random()-0.5)*eq;this.za.y+=(Math.random()-0.5)*eq;this.k=Math.random()*Math.PI*2}function b1(n,g){j.prototype.constructor.call(this,bK,n,eq,bn);this.target=g;this.cd=this.Zc=p;this.We=new cV(0,-10);this.Za=[];for(var r=0;r<4;r++){this.Za.push(new bW(n))}}function c7(n,g,w,u,r){cK.prototype.constructor.call(this,n,r);this.N=new dx(g,w);this.U=u}function bC(g){g.strokeStyle="black";g.beginPath();g.moveTo(-c6,0.075);g.lineTo(c6-0.075,0.075);g.lineTo(c6,0);g.lineTo(c6-0.075,-0.075);g.lineTo(-c6,-0.075);g.closePath();g.fill();g.stroke()}function cW(n,g,w,u,r){c7.prototype.constructor.call(this,r,n,c6,w,a1);this.target=g;this.re=u;this.Ed=aK;this.nc=0;this.b=new cV(an*Math.cos(w),an*Math.sin(w));this.d=[new cF,new cF];this.d[dw].p=function(x){x.fillStyle="red";bC(x)};this.d[cU].p=function(x){x.fillStyle="blue";bC(x)}}function ey(n,g){c7.prototype.constructor.call(this,aq,n,m,0,0);this.target=g;this.R=new cV(0,0);this.ga=0;this.o=new cF;this.o.p=function(x){x.beginPath();x.arc(0,0,0.1,0,2*Math.PI,p);x.fill();x.stroke();x.beginPath();for(var w=0;w<4;w++){var u=w*(2*Math.PI/4),r=Math.cos(u);u=Math.sin(u);x.moveTo(r*0.1,u*0.1);x.lineTo(r*0.3,u*0.3);x.moveTo(r*0.16-u*0.1,u*0.16+r*0.1);x.lineTo(r*0.16+u*0.1,u*0.16-r*0.1);x.moveTo(r*0.23-u*0.05,u*0.23+r*0.05);x.lineTo(r*0.23+u*0.05,u*0.23-r*0.05)}x.stroke()}}function bE(g){c7.prototype.constructor.call(this,et,g,d6,0,dH);this.z=bz;this.R=new cV(0,0);this.Cb=0;this.d=[new cF,new cF,new cF];this.d[b].p=function(n){n.beginPath();n.arc(0,0,0.1,0,2*Math.PI,p);n.stroke()};this.d[bg].p=this.d[k].p=function(n){n.beginPath();n.moveTo(0,0.1);for(var r=0;r<=6;r++){n.lineTo((r&1)/24,0.2+r*0.05)}n.arc(0,0.2,0.3,0.5*Math.PI,-0.5*Math.PI,l);n.stroke()};this.d[bg].K(this.d[b]);this.d[k].K(this.d[b]);this.d[k].bb=l;this.d[b].nb=new cV(0,-0.2)}function bj(n,g){n.strokeStyle="black";n.fillStyle=g?"blue":"red";n.beginPath();n.moveTo(-c6,0.1);n.arc(c6-0.1,0,0.1,Math.PI/2,-Math.PI/2,l);n.lineTo(-c6,-0.1);n.fill();n.stroke();n.fillStyle=g?"red":"blue";n.beginPath();n.arc(-c6,0,0.1,-Math.PI/2,Math.PI/2,p);n.closePath();n.fill();n.stroke()}function cv(n,g,u,r){cW.prototype.constructor.call(this,n,g,u,cX,cx);this.b=new cV(er*Math.cos(u),er*Math.sin(u));this.fd=r;this.Tc=cg;this.d[dw].p=function(w){bj(w,p)};this.d[cU].p=function(w){bj(w,l)}}function aV(n){for(var g=[],r=0;r<n;r++){g.push(0.5+1*Math.random())}return function(y){y.strokeStyle="black";y.beginPath();for(var x=0;x<n;x++){var w=x*(2*Math.PI/n),u=aW*g[x];y.moveTo(0,0);y.lineTo(Math.cos(w)*u,Math.sin(w)*u)}y.stroke()}}function T(n){var g;cK.prototype.constructor.call(this,bT,0);this.N=new dx(n,aW);this.d=[new cF,new cF,new cF];this.d[0].p=aV(11);this.d[1].p=aV(13);this.d[2].p=aV(7);this.d[1].K(this.d[0]);this.d[2].K(this.d[0]);this.d[0].k=(g=2*Math.PI,0+(g-0)*Math.random());this.d[1].k=(g=2*Math.PI,0+(g-0)*Math.random());this.d[2].k=(g=2*Math.PI,0+(g-0)*Math.random())}function ej(n,g,r){dz.prototype.constructor.call(this,-1,n,aD,bw);this.body=r;this.Hd=new dx(n,bf);this.b=g<=Math.PI*0.5||g>Math.PI*0.6666666?new cV(dZ,0):new cV(-dZ,0)}function bQ(n,g){c7.prototype.constructor.call(this,aS,n,aF,0,0);this.target=g;this.Kb=new cV(0,0)}function bt(g){c7.prototype.constructor.call(this,aA,g,ag,0,c);this.o=new cF;this.o.p=function(n){for(var r=-1;r<=1;r+=2){n.fillStyle="red";n.beginPath();n.moveTo(-0.3,r*0.05);n.lineTo(-0.3,r*0.15);n.lineTo(-0.3+(0.15-0.05),r*0.15);n.lineTo(-0.3+(0.15-0.05),r*0.05);n.fill();n.fillStyle="blue";n.beginPath();n.moveTo(0.3,r*0.05);n.lineTo(0.3,r*0.15);n.lineTo(0.3-(0.15-0.05),r*0.15);n.lineTo(0.3-(0.15-0.05),r*0.05);n.fill()}n.strokeStyle="black";n.beginPath();n.arc(0.15,0,0.15,1.5*Math.PI,0.5*Math.PI,l);n.lineTo(0.3,0.15);n.lineTo(0.3,0.05);n.arc(0.15,0,0.05,0.5*Math.PI,1.5*Math.PI,p);n.lineTo(0.3,-0.05);n.lineTo(0.3,-0.15);n.lineTo(0.15,-0.15);n.stroke();n.beginPath();n.arc(-0.15,0,0.15,1.5*Math.PI,2.5*Math.PI,p);n.lineTo(-0.3,0.15);n.lineTo(-0.3,0.05);n.arc(-0.15,0,0.05,2.5*Math.PI,1.5*Math.PI,l);n.lineTo(-0.3,-0.05);n.lineTo(-0.3,-0.15);n.lineTo(-0.15,-0.15);n.stroke()}}function dB(n,g,u,r){cK.prototype.constructor.call(this,n,r);this.N=new dx(g,u)}function bN(n,g){dB.prototype.constructor.call(this,ek,n,aj,0);this.b=g}function aG(n,g){dB.prototype.constructor.call(this,dS,n,dg,0);this.target=g;this.ad=p;this.d=[new cF,new cF,new cF];this.d[b9].p=function(r){r.strokeStyle="black";r.beginPath();r.arc(0,0,0.1,0,2*Math.PI,p);r.stroke();r.fill()};this.d[f].p=this.d[en].p=function(r){r.strokeStyle="black";r.beginPath();r.arc(0,0,0.2,0,Math.PI/2,p);r.arc(0,0,0.15,Math.PI/2,0,l);r.stroke();r.beginPath();r.moveTo(0.07,0.07);r.lineTo(0.1,0.1);r.stroke()};this.d[f].K(this.d[b9]);this.d[en].K(this.d[b9])}function bR(n,g){dB.prototype.constructor.call(this,cL,n,al,0);this.b=new cV(i*Math.cos(g),i*Math.sin(g))}function bu(n,g){dB.prototype.constructor.call(this,co,n,dV,1);this.vc=b2;this.b=new cV(ep*Math.cos(g),ep*Math.sin(g))}function dY(n,g,r){dB.prototype.constructor.call(this,bF,n,dj,dC);this.b=new cV(r*Math.cos(g),r*Math.sin(g));this.mc=dX}function aI(){this.yc=new bL;this.Xb=this.Yb=0;this.$c=p;this.hc=o;this.ed=p;cQ=new dk}function cO(B,A,z,y,x){var w=A.length;if(!(w<1)){B.font=x+"px Arial, sans-serif";x=x+2;for(var u=x*w,r=-1,n=0;n<w;++n){var g=B.measureText(A[n]).width;if(r<g){r=g}}B.fillStyle="#BFBFBF";B.strokeStyle="#7F7F7F";B.lineWidth=1;n=z-r/2-cq;g=y-u/2-b4;B.fillRect(n,g,r+cq*2,u+b4*2);B.strokeRect(n,g,r+cq*2,u+b4*2);B.fillStyle="black";B.textAlign="center";y=y+4-(w-1)*x/2;for(n=0;n<w;++n){B.fillText(A[n],z,y);y+=x}}}function bq(g){return g?g.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"):""}function bp(n,g,u){function r(){$("#loadingScreen").html("Could not load "+n+" from<br><b>"+bq(g)+"</b>")}$.ajax({url:g,type:"GET",cache:p,dataType:"json",success:function(w){w!=o?u(w):r()},error:function(){r()}})}function d1(n,g,r){this.J=n;this.title=g;this.Wd=r}function ao(){this.A=o;this.ta=[];this.sa=p;this.selectedIndex=-1}function cD(){this.J=this.A=o;this.sa=p;this.canvas=$("#canvas")[0];this.canvas.width=800;this.canvas.height=600;this.context=this.canvas.getContext("2d");this.ec=new Date;this.dd=this.X=o}function dl(){this.ud=this.hash=this.J=this.A=o}function a2(){var n=$("body").scrollTop(),g=$(window).height(),u=$("#game").offset().top,r=$("#game").outerHeight();if(u<n||u+r>n+g){$("html, body").animate({scrollTop:u+(r-g)/2})}}function aL(){if(df.ke()){if(df.A==o){df.Ib("rapt",o)}else{if(df.J==o){cw.X=o;var g=di.bc(cw.A,cw.J);if(g!==-1){di.selectedIndex=g}di.load(df.A,function(){di.show()});di.show()}else{a2();di.load(df.A);cw.load(df.A,df.J,function(){cw.show()});cw.show()}}}cw.B()}function cF(){this.k=this.bb=0;this.n=new cV(0,0);this.nb=new cV(0,0);this.p=this.nextSibling=this.firstChild=this.parent=o}function cV(n,g){this.x=n;this.y=g}function cI(n,g){this.f=new cV(n,g);this.xa=[]}function dr(){function n(u){u.strokeStyle="black";u.beginPath();u.moveTo(0,0);u.lineTo(0,-at);u.stroke()}for(var g=[],r=0;r<s;r++){g.push(new cF)}g[a8].p=function(u){u.strokeStyle="black";u.fillStyle="black";u.beginPath();u.moveTo(0.2,-0.2);u.lineTo(-0.2,-0.2);u.lineTo(-0.3,0);u.lineTo(-0.2,0.2);u.lineTo(0.2,0.2);u.lineTo(0.3,0);u.lineTo(0.2,-0.2);u.moveTo(0.15,-0.15);u.lineTo(-0.15,-0.15);u.lineTo(-0.23,0);u.lineTo(-0.15,0.15);u.lineTo(0.15,0.15);u.lineTo(0.23,0);u.lineTo(0.15,-0.15);u.stroke();u.beginPath();u.arc(-0.075,0,0.04,0,2*Math.PI,p);u.arc(0.075,0,0.04,0,2*Math.PI,p);u.fill()};for(r=0;r<4;r++){g[a4+r].p=n;g[bH+r].p=n;g[a4+r].K(g[a8]);g[bH+r].K(g[a4+r]);g[bH+r].n=new cV(0,-at)}g[a4].n=new cV(-0.2,-0.2);g[cR].n=new cV(-0.1,-0.2);g[cs].n=new cV(0.1,-0.2);g[b6].n=new cV(0.2,-0.2);return g}function aP(g){dz.prototype.constructor.call(this,bM,g,aN,bo);this.gc=p;this.lc=ev;this.d=dr()}function d8(n){n.beginPath();for(var g=0;g<=21;g++){var u=(0.25+0.5*g/21)*Math.PI,r=0.6+0.05*(g&2);n.lineTo(Math.cos(u)*r,Math.sin(u)*r-0.5)}for(g=21;g>=0;g--){u=(0.25+0.5*g/21)*Math.PI;n.lineTo(Math.cos(u)*0.5,Math.sin(u)*0.5-0.5)}n.fill()}function a3(g){g.beginPath();g.moveTo(0,0);g.lineTo(0,-dK);g.stroke()}function d5(n,g){var u,r;ds.prototype.constructor.call(this,aM,(u=new cV(0,0.81-aD+aQ*0.5),r=new cV(0,0),r.x=n.x+u.x,r.y=n.y+u.y,r),cf,aQ,ar,q,0);this.Sa=l;this.ib=new cV(0,0);this.pb=new cV(0,0);this.$=0;this.Ta=new ej(n,g,this);cQ.Ea(this.Ta,this.Ta.u().a());u=[];for(r=0;r<cY;r++){u.push(new cF);u[r].p=r==0?d8:a3}for(r=dG;r<=cy;r++){u[r].K(u[au])}for(r=d3;r<=ch;r++){u[r].K(u[r-d3+dG])}u[dG].n=new cV(cf*0.35,0);u[eu].n=new cV(cf*0.15,0);u[d7].n=new cV(cf*-0.05,0);u[dJ].n=new cV(cf*-0.25,0);u[cZ].n=new cV(cf*0.25,0);u[cz].n=new cV(cf*0.05,0);u[ci].n=new cV(cf*-0.15,0);u[cy].n=new cV(cf*-0.35,0);for(r=d3;r<=ch;r++){u[r].n=new cV(0,-dK)}this.d=u;this.Qb=this.Pb=0}function cP(n,g,w,u,r){g/=50;w/=50;u/=50;r/=50;n.beginPath();n.moveTo(g,u);n.lineTo(w,r);n.lineTo(-w,r);n.lineTo(-g,u);n.closePath();n.fill();n.stroke()}function bV(){for(var n=[],g=0;g<bx;g++){n.push(new cF)}n[du].p=function(w){var u=10,r=18;cP(w,2.5,2.5,1,u);u/=50;r/=50;w.beginPath();w.moveTo(0,u);w.lineTo(0,r-0.02);w.arc(0,r,0.02,-Math.PI/2,Math.PI*3/2,p);w.stroke()};n[bS].p=function(r){cP(r,1.5,1.5,0,15)};n[cT].p=n[cu].p=function(r){cP(r,1.5,1,0,-10)};n[b8].p=n[bP].p=function(r){cP(r,1,1.5,0,-10)};n[t].p=n[ew].p=function(r){cP(r,1.5,0.5,0,-9)};n[bs].p=n[a6].p=function(r){cP(r,0.5,1.5,0,-10)};n[du].K(n[bS]);n[t].K(n[bS]);n[ew].K(n[bS]);n[bs].K(n[t]);n[a6].K(n[ew]);n[cT].K(n[bS]);n[cu].K(n[bS]);n[b8].K(n[cT]);n[bP].K(n[cu]);n[du].n=new cV(0,0.34);n[b8].n=new cV(0,-0.2);n[bP].n=new cV(0,-0.2);n[t].n=new cV(0,0.3);n[ew].n=new cV(0,0.3);n[bs].n=new cV(0,-0.18);n[a6].n=new cV(0,-0.18);return n}function dq(n,g){dv.prototype.constructor.call(this);this.reset(n,g)}dA.prototype.$d=function(n,g,w,u,r){g<0&&cE(n,-100,0,100,this.height);w<0&&cE(n,-100,-100,this.width+200,100);u>this.width&&cE(n,this.width,0,100,this.height);r>this.height&&cE(n,-100,this.height,this.width+200,100)};dA.prototype.e=function(n,g,y,x,w){n.fillStyle="#7F7F7F";n.strokeStyle="#7F7F7F";this.$d(n,g,y,x,w);g=Math.max(0,Math.floor(g));y=Math.max(0,Math.floor(y));x=Math.min(this.width,Math.ceil(x));w=Math.min(this.height,Math.ceil(w));for(var u=g;u<x;u++){for(var r=y;r<w;r++){this.cells[u][r].e(n)}}n.strokeStyle="black";for(u=g;u<x;u++){for(r=y;r<w;r++){this.cells[u][r].ae(n)}}};dA.prototype.Y=function(n,g){return n>=0&&g>=0&&n<this.width&&g<this.height?this.cells[n][g]:o};dA.prototype.cb=function(n,g){return n>=0&&g>=0&&n<this.width&&g<this.height?this.cells[n][g].type:dm};dA.prototype.Ee=function(n,g,r){this.cells[n][g]=new dn(n,g,r)};dA.prototype.Td=function(){for(var n=0;n<this.cells.length;n++){for(var g=0;g<this.cells[0].length;g++){this.cells[n][g].s=this.Ud(n,g)}}};dA.prototype.Ud=function(D,C){var B=[],A=this.cb(D,C),z=this.cb(D-1,C),y=this.cb(D,C-1),x=this.cb(D+1,C),w=this.cb(D,C+1),u=new cV(D,C),r=new cV(D+1,C),n=new cV(D,C+1),g=new cV(D+1,C+1);(A==ay||A==bv||A==a9)&&(z==dm||z==bv||z==a9)&&B.push(new dE(u,n,aR));(A==ay||A==az||A==a9)&&(y==dm||y==az||y==a9)&&B.push(new dE(r,u,aR));(A==ay||A==af||A==az)&&(x==dm||x==af||x==az)&&B.push(new dE(g,r,aR));(A==ay||A==af||A==bv)&&(w==dm||w==af||w==bv)&&B.push(new dE(n,g,aR));if(A==bv){B.push(new dE(g,u,aR))}else{if(A==az){B.push(new dE(u,g,aR))}else{if(A==af){B.push(new dE(r,n,aR))}else{A==a9&&B.push(new dE(n,r,aR))}}}return B};dA.prototype.zb=function(n,g){for(var z=Math.max(0,Math.floor(n.m.y)),y=Math.min(this.width,Math.ceil(n.eb())),x=Math.min(this.height,Math.ceil(n.gb())),w=[],u=Math.max(0,Math.floor(n.m.x));u<y;u++){for(var r=z;r<x;r++){w=w.concat(this.cells[u][r].de(g))}}return w};dA.prototype.ee=function(n){var g=Math.max(0,Math.floor(n.m.y)),x=Math.min(this.width,Math.ceil(n.eb())),w=Math.min(this.height,Math.ceil(n.gb())),u=[];for(n=Math.max(0,Math.floor(n.m.x));n<x;n++){for(var r=g;r<w;r++){u=u.concat(this.cells[n][r])}}return u};dA.prototype.ge=function(){return new cJ(new cV(-60,-60),new cV(this.width+60,this.height+60))};dA.prototype.$b=M("width");dA.prototype.Pc=M("height");var ay=0,dm=1,af=2,bv=3,az=4,a9=5;dn.prototype.zc=function(){return this.type===dm||this.type===az||this.type===a9};dn.prototype.Mc=function(){return this.type===dm||this.type===af||this.type===bv};dn.prototype.gd=function(){return this.type===dm||this.type===af||this.type===az};dn.prototype.yd=function(){return this.type===dm||this.type===bv||this.type===a9};dn.prototype.Ae=function(){return this.type===dm||this.type===bv||this.type===az};dn.prototype.te=function(){return this.type===dm||this.type===af||this.type===a9};dn.prototype.Id=function(g){this.s.push(g)};dn.prototype.Be=function(g){this.s.splice(this.Oc(g),1)};dn.prototype.de=function(n){for(var g=[],r=0;r<this.s.length;r++){this.s[r].Md(n)&&g.push(this.s[r])}return g};dn.prototype.Oc=function(n){for(var g,y,x,w,u=0;u<this.s.length;++u){var r=this.s[u];if((g=(y=r.C.start,x=n.C.start,w=new cV(0,0),w.x=y.x-x.x,w.y=y.y-x.y,w),g.x*g.x+g.y*g.y)<0.001&&(g=(y=r.C.end,x=n.C.end,w=new cV(0,0),w.x=y.x-x.x,w.y=y.y-x.y,w),g.x*g.x+g.y*g.y)<0.001){return u}}return -1};dn.prototype.u=function(){var n=new cV(this.x,this.y),g=new cV(0,0),w=new cV(0,1),u=new cV(1,0),r=new cV(1,1);switch(this.type){case dm:return new dy(n,g,u,r,w);case af:return new dy(n,g,u,w);case bv:return new dy(n,g,u,r);case az:return new dy(n,g,r,w);case a9:return new dy(n,w,u,r)}return o};dn.prototype.e=function(n){var g=this.x,r=this.y;n.beginPath();if(this.type==dm){n.moveTo(g,r);n.lineTo(g,r+1);n.lineTo(g+1,r+1);n.lineTo(g+1,r)}else{if(this.type==af){n.moveTo(g,r);n.lineTo(g+1,r);n.lineTo(g,r+1)}else{if(this.type==bv){n.moveTo(g,r);n.lineTo(g+1,r+1);n.lineTo(g+1,r)}else{if(this.type==az){n.moveTo(g,r);n.lineTo(g,r+1);n.lineTo(g+1,r+1)}else{if(this.type==a9){n.moveTo(g+1,r);n.lineTo(g,r+1);n.lineTo(g+1,r+1)}}}}}n.closePath();n.fill();n.stroke()};dn.prototype.ae=function(n){for(var g=0;g<this.s.length;g++){this.s[g].e(n)}};var aR=0,bZ=1,bB=2;dE.prototype.Md=function(g){switch(this.color){case aR:return l;case bZ:return g!=bZ;case bB:return g!=bB;case 3:return g!=bZ&&g!=bB;case 4:return g!=4}return p};dE.prototype.qa=function(){return dE.qa(this.C.q)};dE.qa=function(g){if(g.x>0.9){return 1}if(g.x<-0.9){return 2}if(g.y<0){return 3}return 0};dE.prototype.e=function(B){var A,z,y,x,w;switch(this.color){case aR:B.strokeStyle="black";break;case bZ:B.strokeStyle="#C00000";break;case bB:B.strokeStyle="#0000D2"}this.C.e(B);var u=this.C.q.x*0.1,r=this.C.q.y*0.1;B.beginPath();for(var n=1;n<9;++n){var g=n/9;g=(A=(y=this.C.start,x=new cV(0,0),x.x=y.x*g,x.y=y.y*g,x),z=(y=this.C.end,x=1-g,w=new cV(0,0),w.x=y.x*x,w.y=y.y*x,w),A.x+=z.x,A.y+=z.y,A);B.moveTo(g.x,g.y);B.lineTo(g.x-u,g.y-r)}B.stroke()};var dN=0,ck=3,cQ,V=0,a=0,ei=0,dQ=0;dk.prototype.wd=function(){this.Wa++};dk.prototype.Zb=function(g){return g==0?this.i:this.r};dk.prototype.Ab=function(g){return g==this.i?this.r:this.i};dk.prototype.Fe=function(g){this.j.ma=new cV(g.x,g.y);this.Dd.y=0.125;this.j.ma.y+=0.01};dk.prototype.ce=function(){var n=this.j.Rc,g=!this.i.l&&Math.abs(this.i.a().x-n.x)<0.4&&Math.abs(this.i.a().y-n.y)<0.4;n=!this.r.l&&Math.abs(this.r.a().x-n.x)<0.4&&Math.abs(this.r.a().y-n.y)<0.4;return g&&n};dk.prototype.be=function(){return this.i.l&&this.r.l};dk.prototype.ra=function(g){++this.O[g]};dk.prototype.Ea=function(n,g){var w,u;if(typeof g==="undefined"){g=n.u().a()}else{n.u().moveTo(g)}var r={c:(w=n.u().a(),u=new cV(0,0),u.x=w.x-g.x,u.y=w.y-g.y,u)};w={c:n.b};cN.Ub(n,r,w,n.I,this.j,l);n.la(w.c);n.u().moveBy(r.c);this.S.push(n)};dk.prototype.sc=function(A,z,y,x,w){var u,r,n=l;if(A.y+1==z.y&&A.x==z.x){u=this.j.Y(A.x,A.y);r=this.j.Y(A.x-1,A.y);if(!u||!r||u.gd()||r.yd()){n=p}}else{if(A.y-1==z.y&&A.x==z.x){u=this.j.Y(A.x-1,z.y);r=this.j.Y(A.x,z.y);if(!u||!r||u.yd()||r.gd()){n=p}}else{if(A.x+1==z.x&&A.y==z.y){u=this.j.Y(A.x,A.y-1);r=this.j.Y(A.x,A.y);if(!u||!r||u.zc()||r.Mc()){n=p}}else{if(A.x-1==z.x&&A.y==z.y){u=this.j.Y(z.x,A.y);r=this.j.Y(z.x,A.y-1);if(!u||!r||u.Mc()||r.zc()){n=p}}else{r=A.x<z.x?A.x:z.x;var g=A.y<z.y?A.y:z.y;u=this.j.Y(r,g);r=this.j.Y(r,g);if(A.x<z.x===A.y<z.y){if(!u||u.Ae()){n=p}}else{if(!u||u.te()){n=p}}}}}}A=n?y===bU?new eg(new dE(A,z,x),o,u,o):new eg(new dE(A,z,x),new dE(z,A,x),u,r):new eg(o,o,o,o);this.Ga.push(A);w||A.rc(by,l,p)};dk.prototype.fe=function(g){return this.Ga[g]};dk.prototype.oe=function(n){for(var g=0;g<2;++g){cN.Xc(this.Zb(g),n.C)&&this.Zb(g).w(l)}for(g=0;g<this.S.length;++g){var r=this.S[g];r.ba()&&cN.Xc(r,n.C)&&r.w(l)}};dk.prototype.B=function(n){var g,w,u;if(this.ca===1||this.ce()){this.ca=1}else{if(this.ca===2||this.be()){this.ca=2}}this.$+=n;if(this.killKey){this.i.w(l);this.r.w(l)}this.i.B(n);this.r.B(n);for(var r=0;r<this.S.length;++r){this.S[r].B(n)}for(r=0;r<this.S.length;++r){this.S[r].l&&this.S.splice(r,1)}this.kc-=n;if(this.kc<=0){n=(g=this.j.ma,w=new cV(0,0.25),u=new cV(0,0),u.x=g.x-w.x,u.y=g.y-w.y,u);dI().position(n).b(new cV((g=-0.3,g+(0.3-g)*Math.random()),0.3)).h(0.03,0.05).D(0).F(0.1,0.2).color(1,1,1,1).pa().ja(-5);this.kc+=0.3}};dk.prototype.e=function(n,g,z,y,x){var w,u,r;V=g-2;a=z-2;ei=y+2;dQ=x+2;g=(w=this.j.ma,u=this.Dd,r=new cV(0,0),r.x=w.x+u.x,r.y=w.y+u.y,r);w=this.j.Rc;if(g.x>=V&&g.y>=a&&g.x<=ei&&g.y<=dQ){n.strokeStyle=n.fillStyle="rgba(255, 255, 255, 0.1)";n.beginPath();n.arc(g.x,g.y,1,0,2*Math.PI,p);n.stroke();n.fill();u=n.createLinearGradient(0,g.y-0.4,0,g.y+0.6);u.addColorStop(0,"rgba(255, 255, 255, 0.75)");u.addColorStop(1,"rgba(255, 255, 255, 0)");n.fillStyle=u;n.beginPath();n.lineTo(g.x-0.35,g.y+0.6);n.lineTo(g.x-0.1,g.y-0.4);n.lineTo(g.x+0.1,g.y-0.4);n.lineTo(g.x+0.35,g.y+0.6);n.fill();n.fillStyle="black";n.beginPath();n.moveTo(g.x-0.1,g.y-0.45);n.lineTo(g.x-0.1,g.y-0.4);n.lineTo(g.x+0.1,g.y-0.4);n.lineTo(g.x+0.1,g.y-0.45);n.arc(g.x,g.y-0.45,0.2,0,Math.PI,l);n.fill()}if(w.x>=V&&w.y>=a&&w.x<=ei&&w.y<=dQ){u=this.$;u=u-Math.floor(u);u=1-u;u=(u-Math.pow(u,6))*1.72;u=1-u;n.fillStyle="black";for(r=0;r<4;++r){z=r*(2*Math.PI/4);g=Math.sin(z);z=Math.cos(z);y=0.45-u*0.25;n.beginPath();n.moveTo(w.x+z*y-g*0.15,w.y+g*y+z*0.15);n.lineTo(w.x+z*y+g*0.15,w.y+g*y-z*0.15);n.lineTo(w.x+z*(y-0.15),w.y+g*(y-0.15));n.fill()}}this.i.e(n);this.r.e(n);for(w=0;w<this.S.length;++w){u=this.S[w];r=u.a();r.x>=V&&r.y>=a&&r.x<=ei&&r.y<=dQ&&u.e(n)}};cJ.fc=function(n,g,u){var r;u=new cV(g*0.5,u*0.5);g=(r=new cV(0,0),r.x=n.x-u.x,r.y=n.y-u.y,r);n=(r=new cV(0,0),r.x=n.x+u.x,r.y=n.y+u.y,r);return new cJ(g,n)};cJ.prototype.gb=function(){return this.m.y+this.size.y};cJ.prototype.eb=function(){return this.m.x+this.size.x};cJ.prototype.$b=function(){return this.size.x};cJ.prototype.Pc=function(){return this.size.y};cJ.prototype.copy=function(){var n,g,r;return new cJ(this.m,(n=this.m,g=this.size,r=new cV(0,0),r.x=n.x+g.x,r.y=n.y+g.y,r))};cJ.prototype.Ha=function(){var n,g,u=this.a(),r=(n=this.size,g=new cV(0,0),g.x=n.x/2,g.y=n.y/2,g);return new dy(u,new cV(+r.x,+r.y),new cV(-r.x,+r.y),new cV(-r.x,-r.y),new cV(+r.x,-r.y))};cJ.prototype.P=function(){return dR};cJ.prototype.T=function(){return this};cJ.prototype.moveBy=function(n){var g,r;this.m=(g=this.m,r=new cV(0,0),r.x=g.x+n.x,r.y=g.y+n.y,r)};cJ.prototype.moveTo=function(n){var g,w,u,r;this.m=(g=(u=this.size,r=new cV(0,0),r.x=u.x/2,r.y=u.y/2,r),w=new cV(0,0),w.x=n.x-g.x,w.y=n.y-g.y,w)};cJ.prototype.a=function(){var n,g,w,u,r;return n=this.m,g=(u=this.size,r=new cV(0,0),r.x=u.x/2,r.y=u.y/2,r),w=new cV(0,0),w.x=n.x+g.x,w.y=n.y+g.y,w};cJ.prototype.expand=function(n){var g,w,u,r;n=new cV(n,n);return new cJ((g=this.m,w=new cV(0,0),w.x=g.x-n.x,w.y=g.y-n.y,w),(g=(w=this.m,u=this.size,r=new cV(0,0),r.x=w.x+u.x,r.y=w.y+u.y,r),g.x+=n.x,g.y+=n.y,g))};cJ.prototype.Pe=function(n){var g,x,w,u,r;return new cJ((g=this.m,x=n.m,w=new cV(0,0),w.x=Math.min(g.x,x.x),w.y=Math.min(g.y,x.y),w),(g=(w=this.m,u=this.size,r=new cV(0,0),r.x=w.x+u.x,r.y=w.y+u.y,r),x=(w=n.m,u=n.size,r=new cV(0,0),r.x=w.x+u.x,r.y=w.y+u.y,r),g.x=Math.max(g.x,x.x),g.y=Math.max(g.y,x.y),g))};cJ.prototype.le=function(n){var g,w,u,r;return new cJ((g=this.m,w=new cV(0,0),w.x=Math.min(g.x,n.x),w.y=Math.min(g.y,n.y),w),(g=(w=this.m,u=this.size,r=new cV(0,0),r.x=w.x+u.x,r.y=w.y+u.y,r),g.x=Math.max(g.x,n.x),g.y=Math.max(g.y,n.y),g))};cJ.prototype.Fb=function(n){var g,w,u,r;return new cJ((g=this.m,w=new cV(0,0),w.x=g.x+n.x,w.y=g.y+n.y,w),(g=(w=this.m,u=this.size,r=new cV(0,0),r.x=w.x+u.x,r.y=w.y+u.y,r),g.x+=n.x,g.y+=n.y,g))};cJ.prototype.e=function(g){g.strokeStyle="black";g.strokeRect(this.m.x,this.m.y,this.size.x,this.size.y)};var dR=1;dy.prototype.copy=function(){var g=new dy(this.f,this.v[0]);g.v=this.v;g.Na=this.Na;g.Uc();return g};dy.prototype.P=N(2);dy.prototype.moveBy=function(n){var g,r;this.f=(g=this.f,r=new cV(0,0),r.x=g.x+n.x,r.y=g.y+n.y,r)};dy.prototype.moveTo=function(g){this.f=g};dy.prototype.hb=function(n){var g,u,r;return g=this.v[n],u=this.f,r=new cV(0,0),r.x=g.x+u.x,r.y=g.y+u.y,r};dy.prototype.fb=function(g){return this.Na[g].Fb(this.f)};dy.prototype.T=function(){return this.Sb.Fb(this.f)};dy.prototype.a=M("f");dy.prototype.Uc=function(){for(var g=0;g<this.v.length;g++){this.Sb=this.Sb.le(this.v[g])}};dy.prototype.e=function(n){n.strokeStyle="black";n.beginPath();for(var g=0;g<this.v.length;g++){n.lineTo(this.v[g].x+this.f.x,this.v[g].y+this.f.y)}n.closePath();n.stroke()};cN.Ub=function(n,g,x,w,u,r){return this.Qd(n.u(),g,x,w,u,n.db(),r)};cN.Qd=function(U,S,R,Q,P,O,J){var G,E,D,C,A,z,y,x,w;if((G=S.c,G.x*G.x+G.y*G.y)<1e-12){S.c=new cV(0,0);return o}if((G=R.c,G.x*G.x+G.y*G.y)>900){R.c=(G=(E=R.c,D=new cV(0,0),C=Math.sqrt(E.x*E.x+E.y*E.y),D.x=E.x/C,D.y=E.y/C,D),G.x*=30,G.y*=30,G)}for(var n=o,u=S.c,I=R.c,g=0;g<20;g++){var r=U.copy();r.moveBy(S.c);r=U.T().Pe(r.T());var H=P.zb(r,O);r=o;for(var L=0;L<H.length;L++){var B=this.Pd(U,S.c,H[L].C);if(r===o||B!==o&&B.Ba<r.Ba){r=B}}if(r===o){this.Jc(U,S,R,P);return n}n=R.c.ob(r.q);H=(G=R.c,E=new cV(0,0),E.x=G.x-n.x,E.y=G.y-n.y,E);R.c=(G=(D=-Q,C=new cV(0,0),C.x=n.x*D,C.y=n.y*D,C),E=new cV(0,0),E.x=H.x+G.x,E.y=H.y+G.y,E);n=S.c.ob(r.q);H=(G=S.c,E=new cV(0,0),E.x=G.x-n.x,E.y=G.y-n.y,E);L=1-r.Ba;S.c=(G=(D=(A=(y=S.c,x=r.Ba,w=new cV(0,0),w.x=y.x*x,w.y=y.y*x,w),z=(y=-Q*L,x=new cV(0,0),x.x=n.x*y,x.y=n.y*y,x),A.x+=z.x,A.y+=z.y,A),C=(A=new cV(0,0),A.x=H.x*L,A.y=H.y*L,A),D.x+=C.x,D.y+=C.y,D),E=(D=r.q,C=new cV(0,0),C.x=D.x*0.0001,C.y=D.y*0.0001,C),G.x+=E.x,G.y+=E.y,G);n=r}typeof console!=="undefined"&&console.log&&console.log("Collision loop ran out, damn!");S.c=new cV(0,0);R.c=(G=-(Q<0.5?Q:0.5),E=new cV(0,0),E.x=I.x*G,E.y=I.y*G,E);J&&this.Jc(U,{c:u},R,P);return n};cN.qd=function(n){var g=[];this.Gb(cQ.i.u(),n)&&g.push(cQ.i);this.Gb(cQ.r.u(),n)&&g.push(cQ.r);return g};cN.Ve=function(){return this.Gb(cQ.i.u(),cQ.r.u())};cN.pd=function(n,g,r){this.ye(n,g,r);g.Ke(0.01)};cN.Ia=function(D,C,B){var A,z,y;if((A=(z=new cV(0,0),z.x=C.x-D.x,z.y=C.y-D.y,z),A.x*A.x+A.y*A.y)>625){return o}B=B.zb(new cJ(D,C),4);for(var x=1.1,w={},u={},r=o,n=0;n<B.length;n++){if(!((A=(y=new cV(0,0),y.x=C.x-D.x,y.y=C.y-D.y,y),z=B[n].C.q,A.x*z.x+A.y*z.y)>=0)){var g={};if(this.ka(new dp(D,C),B[n].C,g,w,u)){if(!(g.c>=x)){x=g.c;r=B[n]}}}}return r};cN.$a=function(A,z,y,x,w){var u=A.u();z=u.T().expand(z);A=w.zb(z,A.db());w=Number.POSITIVE_INFINITY;for(z=0;z<A.length;z++){var r={},n={},g=this.Bc(u,r,n,A[z].C);if(g<w){w=g;y.c=r.c;x.c=n.c}}return w};cN.Sd=function(C,B){var A,z,y,x,w,u,r;switch(B.P()){case 0:return(A=(z=B.f,y=new cV(0,0),y.x=C.x-z.x,y.y=C.y-z.y,y),A.x*A.x+A.y*A.y)<B.h*B.h;case dR:return C.x>=B.m.x&&C.x<=B.m.x+B.size.x&&C.y>=B.m.y&&C.y<=B.m.y+B.size.y;case 2:for(var n=B.v.length,g=0;g<n;++g){if((A=(y=(w=B.v[g],u=B.f,r=new cV(0,0),r.x=w.x+u.x,r.y=w.y+u.y,r),x=new cV(0,0),x.x=C.x-y.x,x.y=C.y-y.y,x),z=B.Na[g].q,A.x*z.x+A.y*z.y)>0){return p}}return l}alert("assertion failed in CollisionDetector.containsPointShape")};cN.Xc=function(n,g){return this.Yc(n.u(),g)};cN.ka=function(C,B,A,z,y){var x,w,u,r,n=C.start;C=C.end;C=(x=new cV(0,0),x.x=C.x-n.x,x.y=C.y-n.y,x);var g=B.start;B=B.end;B=(x=new cV(0,0),x.x=B.x-g.x,x.y=B.y-g.y,x);if(Math.abs((x=(w=new cV(0,0),w.x=B.y,w.y=-B.x,w),C.x*x.x+C.y*x.y))<0.000001){return p}A.c=((g.y-n.y)*B.x+(n.x-g.x)*B.y)/(C.y*B.x-B.y*C.x);z.c=((n.y-g.y)*C.x+(g.x-n.x)*C.y)/(B.y*C.x-C.y*B.x);y.c=(x=(u=A.c,r=new cV(0,0),r.x=C.x*u,r.y=C.y*u,r),w=new cV(0,0),w.x=n.x+x.x,w.y=n.y+x.y,w);if(A.c<0||A.c>1){return p}if(z.c<0||z.c>1){return p}return l};cN.Vc=function(A,z,y,x){var w,u,r,n=z.start;z=z.end;var g=(w=new cV(0,0),w.x=z.x-n.x,w.y=z.y-n.y,w);z=g.x*g.x+g.y*g.y;g=2*(w=(u=A.f,r=new cV(0,0),r.x=n.x-u.x,r.y=n.y-u.y,r),g.x*w.x+g.y*w.y);A=(w=(u=A.f,r=new cV(0,0),r.x=n.x-u.x,r.y=n.y-u.y,r),w.x*w.x+w.y*w.y)-A.h*A.h;w=g*g-4*z*A;if(w<0){return p}y.c=(-g-Math.sqrt(w))*0.5/z;x.c=(-g+Math.sqrt(w))*0.5/z;return l};cN.Yc=function(n,g){switch(n.P()){case 0:return this.Wc(n,g);case dR:return this.cc(n.Ha(),g);case 2:return this.cc(n,g)}alert("assertion failed in CollisionDetector.intersectShapeSegment")};cN.Wc=function(n,g){var u={},r={};if(!this.Vc(n,g,u,r)){return p}if(u.c>=0&&u.c<=1){return l}return r.c>=0&&r.c<=1};cN.cc=function(n,g){for(var x={},w={},u={},r=0;r<n.v.length;r++){if(this.ka(n.fb(r),g,x,w,u)){return l}}return p};cN.Pd=function(n,g,u){var r=u.q;if(g.x*r.x+g.y*r.y>0){return o}switch(n.P()){case 0:return this.Od(n,g,u);case dR:return this.Dc(n.Ha(),g,u);case 2:return this.Dc(n,g,u)}alert("assertion failed in CollisionDetector.collideShapeSegment")};cN.Od=function(A,z,y){var x,w,u,r=y.q,n=(x=-A.h,w=new cV(0,0),w.x=r.x*x,w.y=r.y*x,w);n=(x=(new dx((x=A.f,w=new cV(0,0),w.x=x.x+z.x,w.y=x.y+z.y,w),A.h)).f,w=new cV(0,0),w.x=x.x+n.x,w.y=x.y+n.y,w);if(!((x=(w=y.start,u=new cV(0,0),u.x=n.x-w.x,u.y=n.y-w.y,u),x.x*r.x+x.y*r.y)<0.001)){return o}var g=(x=new cV(0,0),x.x=n.x-z.x,x.y=n.y-z.y,x);if((x=(w=y.start,u=new cV(0,0),u.x=g.x-w.x,u.y=g.y-w.y,u),x.x*r.x+x.y*r.y)>0){x={};w={};if(this.ka(y,new dp(g,n),{},x,w)){return new cm(w.c,r,x.c)}}r=this.Cc(A,z,y.start);A=this.Cc(A,z,y.end);if(!r&&!A){return o}if(r&&!A){return r}if(!r&&A){return A}if(r.Ba<A.Ba){return r}return A};cN.Cc=function(A,z,y){var x,w,u,r,n,g={};if(Math.sqrt(z.x*z.x+z.y*z.y)<1e-7){return p}if(!this.Vc(A,new dp(y,(x=new cV(0,0),x.x=y.x-z.x,x.y=y.y-z.y,x)),g,{})){return o}if(g.c<0||g.c>1){return o}A=(x=A.f,w=(r=g.c,n=new cV(0,0),n.x=z.x*r,n.y=z.y*r,n),u=new cV(0,0),u.x=x.x+w.x,u.y=x.y+w.y,u);return new cm(y,(x=(u=new cV(0,0),u.x=A.x-y.x,u.y=A.y-y.y,u),w=Math.sqrt(x.x*x.x+x.y*x.y),x.x/=w,x.y/=w,x),g.c)};cN.Dc=function(E,D,B){var A,z,y,x,w={},u={},r={};if(this.cc(E,B)){return o}var n=o,g;for(g=0;g<E.v.length;g++){for(var I=[B.start,B.end],H=(A=(z=B.start,y=B.end,x=new cV(0,0),x.x=z.x+y.x,x.y=z.y+y.y,x),A.x/=2,A.y/=2,A),G=0;G<2;G++){var C=E.fb(g);if(!((A=C.q,z=(y=I[G],x=new cV(0,0),x.x=y.x-H.x,x.y=y.y-H.y,x),A.x*z.x+A.y*z.y)>0)){if(this.ka(C,new dp(I[G],(A=I[G],z=new cV(0,0),z.x=A.x-D.x,z.y=A.y-D.y,z)),w,u,r)){if(!n||u.c<n.Ba){n=new cm(r.c,(A=C.q,z=-1,y=new cV(0,0),y.x=A.x*z,y.y=A.y*z,y),u.c)}}}}}for(g=0;g<E.v.length;g++){z=E.hb(g);if(this.ka(B,new dp(z,(A=new cV(0,0),A.x=z.x+D.x,A.y=z.y+D.y,A)),w,u,r)){if(!n||u.c<n.Ba){n=new cm(r.c,B.q,u.c)}}}return n};cN.Jc=function(E,D,B,A){var z,y,x,w,u,r=p;B=E.copy();B.moveBy(D.c);if(B.T().m.y<0){r=l}if(B.T().gb()>A.height){r=l}if(B.T().m.x<0){r=l}if(B.T().eb()>A.width){r=l}if(!r){for(var n=A.ee(B.T()),g=0;g<n.length;g++){var I=n[g].u();if(I){if(this.Gb(B,I)){r=l;break}}}}if(r){var H=Math.floor(B.a().x)-3;r=Math.floor(B.a().x)+3;n=Math.floor(B.a().y)-3;g=Math.floor(B.a().y)+3;I=A.Ad;for(H=H;H<=r;H++){for(var G=n;G<=g;G++){if(!(!A.Y(H,G)||A.Y(H,G).type!=ay)){var C=new cV(H+0.5,G+0.5);if((z=(y=B.a(),x=new cV(0,0),x.x=C.x-y.x,x.y=C.y-y.y,x),z.x*z.x+z.y*z.y)<(z=(y=B.a(),x=new cV(0,0),x.x=I.x-y.x,x.y=I.y-y.y,x),z.x*z.x+z.y*z.y)){I=C}}}}B.moveBy((z=(y=(w=B.a(),u=new cV(0,0),u.x=I.x-w.x,u.y=I.y-w.y,u),x=Math.sqrt(y.x*y.x+y.y*y.y),y.x/=x,y.y/=x,y),z.x*=0.1,z.y*=0.1,z));D.c=(z=B.a(),y=E.a(),x=new cV(0,0),x.x=z.x-y.x,x.y=z.y-y.y,x)}};cN.Gb=function(n,g){var y=o,x=n.copy(),w=g.copy();if(x.P()==dR){x=x.Ha()}if(w.P()==dR){w=w.Ha()}if(x.P()>w.P()){y=w;w=x;x=y}var u;y=x.P();var r=w.P();if(y==0&&r==0){u=this.ve(x,w)}else{if(y==0&&r==2){u=this.ue(x,w)}else{if(y==2&&r==2){u=this.we(x,w)}else{alert("assertion failed in CollisionDetector.overlapShapes")}}}return u};cN.ve=function(n,g){var x,w,u,r;return(x=(w=g.a(),u=n.a(),r=new cV(0,0),r.x=w.x-u.x,r.y=w.y-u.y,r),x.x*x.x+x.y*x.y)<=(n.h+g.h)*(n.h+g.h)};cN.ue=function(D,C){for(var B,A,z,y,x,w,u,r=C.v.length,n=0;n<r;++n){if(this.Wc(D,C.fb(n))){return l}if((B=(A=C.hb(n),z=D.f,y=new cV(0,0),y.x=A.x-z.x,y.y=A.y-z.y,y),B.x*B.x+B.y*B.y)<D.h*D.h){return l}}var g=D.f;for(n=0;n<r;++n){if((B=(z=(x=C.v[n],w=C.f,u=new cV(0,0),u.x=x.x+w.x,u.y=x.y+w.y,u),y=new cV(0,0),y.x=g.x-z.x,y.y=g.y-z.y,y),A=C.Na[n].q,B.x*A.x+B.y*A.y)>0){return p}}return l};cN.we=function(n,g){var z,y,x,w,u=n.v.length,r=g.v.length;for(w=0;w<u;++w){if(this.Ec((z=n.v[w],y=n.f,x=new cV(0,0),x.x=z.x+y.x,x.y=z.y+y.y,x),g)){return l}}for(w=0;w<r;++w){if(this.Ec((z=g.v[w],y=g.f,x=new cV(0,0),x.x=z.x+y.x,x.y=z.y+y.y,x),n)){return l}}return p};cN.Ec=function(C,B){for(var A,z,y,x,w,u,r,n=B.v.length,g=0;g<n;++g){if((A=(y=(w=B.v[g],u=B.f,r=new cV(0,0),r.x=w.x+u.x,r.y=w.y+u.y,r),x=new cV(0,0),x.x=C.x-y.x,x.y=C.y-y.y,x),z=B.Na[g].q,A.x*z.x+A.y*z.y)>0){return p}}return l};cN.Zd=function(n,g){if(this.Yc(n,g)){return 0}return this.Bc(n,{},{},g)};cN.Se=function(n,g){switch(n.P()){case 0:return this.Yd(n,g);case dR:return this.Gc(n.Ha(),g);case 2:return this.Gc(n,g)}alert("assertion failed in CollisionDetector.distanceShapePoint")};cN.Yd=function(n,g){var x,w,u,r=(x=(w=n.f,u=new cV(0,0),u.x=w.x-g.x,u.y=w.y-g.y,u),Math.sqrt(x.x*x.x+x.y*x.y));return r>n.h?r-n.h:0};cN.Gc=function(B,A){for(var z,y,x={},w={},u={},r=Number.POSITIVE_INFINITY,n=0;n<B.v.length;n++){var g=B.fb(n);this.ka(g,new dp(A,(z=g.q,y=new cV(0,0),y.x=A.x+z.x,y.y=A.y+z.y,y)),x,w,u);if(!(x.c<0||x.c>1)){g=Math.abs(w.c);if(g<r){r=g}}}return r};cN.Bc=function(n,g,u,r){switch(n.P()){case 0:return this.Nd(n,g,u,r);case dR:return this.Ac(n.Ha(),g,u,r);case 2:return this.Ac(n,g,u,r)}alert("assertion failed in CollisionDetector.closestToShapeSegment")};cN.Nd=function(E,D,B,A){var z,y,x,w,u,r,n,g,I,H,G={},C={};this.ka(A,new dp(E.f,(z=E.f,y=A.q,x=new cV(0,0),x.x=z.x-y.x,x.y=z.y-y.y,x)),G,C,B);if(G.c>=0&&G.c<=1){D.c=(z=E.f,y=(w=A.q,u=E.h*(C.c>0?1:-1),r=new cV(0,0),r.x=w.x*u,r.y=w.y*u,r),x=new cV(0,0),x.x=z.x-y.x,x.y=z.y-y.y,x);return(z=(y=B.c,x=E.f,w=new cV(0,0),w.x=y.x-x.x,w.y=y.y-x.y,w),Math.sqrt(z.x*z.x+z.y*z.y))-E.h}G=(z=(y=E.f,x=A.start,w=new cV(0,0),w.x=y.x-x.x,w.y=y.y-x.y,w),z.x*z.x+z.y*z.y);C=(z=(y=E.f,x=A.end,w=new cV(0,0),w.x=y.x-x.x,w.y=y.y-x.y,w),z.x*z.x+z.y*z.y);if(G<C){B.c=A.start;D.c=(z=E.f,y=(w=(r=(g=B.c,I=E.f,H=new cV(0,0),H.x=g.x-I.x,H.y=g.y-I.y,H),n=Math.sqrt(r.x*r.x+r.y*r.y),r.x/=n,r.y/=n,r),u=E.h,w.x*=u,w.y*=u,w),x=new cV(0,0),x.x=z.x+y.x,x.y=z.y+y.y,x);return Math.sqrt(G)-E.h}B.c=A.end;D.c=(z=E.f,y=(w=(r=(g=B.c,I=E.f,H=new cV(0,0),H.x=g.x-I.x,H.y=g.y-I.y,H),n=Math.sqrt(r.x*r.x+r.y*r.y),r.x/=n,r.y/=n,r),u=E.h,w.x*=u,w.y*=u,w),x=new cV(0,0),x.x=z.x+y.x,x.y=z.y+y.y,x);return Math.sqrt(C)-E.h};cN.Ac=function(D,C,B,A){for(var z,y,x=Number.POSITIVE_INFINITY,w,u=0;u<D.v.length;u++){for(var r=D.hb(u),n=0;n<2;n++){var g=n==0?A.start:A.end;w=(z=(y=new cV(0,0),y.x=r.x-g.x,y.y=r.y-g.y,y),Math.sqrt(z.x*z.x+z.y*z.y));if(w<x){x=w;B.c=g;C.c=r}}}n={};g={};var H={};for(u=0;u<D.v.length;u++){r=D.hb(u);this.ka(A,new dp(r,(z=A.q,y=new cV(0,0),y.x=r.x-z.x,y.y=r.y-z.y,y)),n,g,H);if(!(n.c<0||n.c>1)){w=Math.abs(g.c);if(w<x){x=w;B.c=H.c;C.c=r}}}r={};var G={};for(u=0;u<D.v.length;u++){var E=D.fb(u);for(n=0;n<2;n++){g=n==0?A.start:A.end;this.ka(E,new dp(g,(z=E.q,y=new cV(0,0),y.x=g.x+z.x,y.y=g.y+z.y,y)),r,G,H);if(!(r.c<0||r.c>1)){w=Math.abs(G.c);if(w<x){x=w;B.c=g;C.c=H.c}}}}return x};cN.ye=function(n,g,w){var u=n.u();g.nd();n=w.zb(u.T().expand(0.1),n.db());for(w=0;w<n.length;w++){if(!(this.Zd(u,n[w].C)>0.01)){var r=this.ze(u,n[w].C);r<0||g.se(n[w],r)}}};cN.ze=function(n,g){switch(n.P()){case 0:return this.xe(n,g);case dR:return this.rd(n.Ha(),g);case 2:return this.rd(n,g)}alert("assertion failed in CollisionDetector.penetrationShapeSegment")};cN.xe=function(n,g){var y,x,w,u,r=(y=g.q,x=-n.h,w=new cV(0,0),w.x=y.x*x,w.y=y.y*x,w);r=(y=n.f,x=new cV(0,0),x.x=y.x+r.x,x.y=y.y+r.y,x);return y=(w=g.start,u=new cV(0,0),u.x=r.x-w.x,u.y=r.y-w.y,u),x=g.q,y.x*x.x+y.y*x.y};cN.rd=function(B,A){for(var z,y,x=Number.POSITIVE_INFINITY,w={},u={},r={},n=0;n<B.v.length;n++){var g=B.hb(n);this.ka(A,new dp(g,(z=A.q,y=new cV(0,0),y.x=g.x-z.x,y.y=g.y-z.y,y)),w,u,r);if(!(w.c<0||w.c>1)){if(u.c<x){x=u.c}}}return x};b0.prototype.nd=function(){this.s=[o,o,o,o]};b0.prototype.se=function(n,g){var r=n.qa();if(this.s[r]==o||g<this.ic[r]){this.s[r]=n;this.ic[r]=g}};b0.prototype.Ke=function(n){for(var g=0;g<4;g++){if(this.ic[g]>n){this.s[g]=o}}};var c9=new b0;dp.prototype.Fb=function(n){var g,r;return new dp((g=this.start,r=new cV(0,0),r.x=g.x+n.x,r.y=g.y+n.y,r),(g=this.end,r=new cV(0,0),r.x=g.x+n.x,r.y=g.y+n.y,r))};dp.prototype.e=function(g){g.beginPath();g.moveTo(this.start.x,this.start.y);g.lineTo(this.end.x,this.end.y);g.stroke()};dx.prototype.copy=function(){return new dx(this.f,this.h)};dx.prototype.P=N(0);dx.prototype.T=function(){var n,g,r=new cV(this.h,this.h);return new cJ((n=this.f,g=new cV(0,0),g.x=n.x-r.x,g.y=n.y-r.y,g),(n=this.f,g=new cV(0,0),g.x=n.x+r.x,g.y=n.y+r.y,g))};dx.prototype.a=M("f");dx.prototype.moveBy=function(n){var g,r;this.f=(g=this.f,r=new cV(0,0),r.x=g.x+n.x,r.y=g.y+n.y,r)};dx.prototype.moveTo=function(g){this.f=g};dx.prototype.Fb=function(n){var g,r;return new dx((g=this.f,r=new cV(0,0),r.x=g.x+n.x,r.y=g.y+n.y,r),this.h)};dx.prototype.e=function(g){g.strokeStyle="black";g.beginPath();g.arc(this.f.x,this.f.y,this.h,0,Math.PI*2,p);g.stroke()};dv.prototype.la=function(g){this.b=g};dv.prototype.w=function(g){if(this.l!==g){(this.l=g)&&this.L()}};dv.prototype.a=function(){return this.u().a()};dv.prototype.Bd=function(g){this.u().moveTo(g)};dv.prototype.db=function(){throw"Entity.getColor() unimplemented"};dv.prototype.u=function(){throw"Entity.getShape() unimplemented"};dv.prototype.a=function(){return this.u().a()};dv.prototype.Bd=function(g){this.u().moveTo(g)};dv.prototype.Bb=function(){cN.pd(this,c9,cQ.j);return c9.s[0]!=o};dv.prototype.B=function(){throw"Entity.tick() unimplemented"};dv.prototype.e=function(){throw"Entity.draw() unimplemented"};dv.prototype.L=F();dD.prototype.me=function(){this.qe=this.md=this.lb=this.va=this.Ja=this.Ka=this.La=this.mb=this.Eb=0;this.ld=this.jd=1;this.Q=new cV(0,0);this.Va=new cV(0,0);this.hd=this.kb=0;this.kd=o};dD.prototype.B=function(n){var g,x,w,u,r;if(this.Eb<0){return p}this.va*=Math.pow(this.jd,n);this.lb*=Math.pow(this.ld,n);this.Va.y-=this.md*n;this.Q=(g=this.Q,x=(u=this.Va,r=new cV(0,0),r.x=u.x*n,r.y=u.y*n,r),w=new cV(0,0),w.x=g.x+x.x,w.y=g.y+x.y,w);this.kb+=this.hd*n;if(this.va<0.05){this.Eb=-1}return this.Eb>=0};dD.prototype.e=function(B){var A,z,y,x,w,u;switch(this.mb){case 0:B.fillStyle=bD(this.La,this.Ka,this.Ja,this.va);B.beginPath();B.arc(this.Q.x,this.Q.y,this.lb,0,2*Math.PI,p);B.fill();break;case 1:var r=(A=this.Q,z=(x=this.Va,w=new cV(0,0),w.x=x.x*0.04,w.y=x.y*0.04,w),y=new cV(0,0),y.x=A.x+z.x,y.y=A.y+z.y,y),n=(A=this.Q,z=(x=(w=this.Va,u=new cV(0,0),u.x=w.y,u.y=-w.x,u),x.x*=0.01,x.y*=0.01,x),y=new cV(0,0),y.x=A.x-z.x,y.y=A.y-z.y,y),g=(A=this.Q,z=(x=(w=this.Va,u=new cV(0,0),u.x=w.y,u.y=-w.x,u),x.x*=0.01,x.y*=0.01,x),y=new cV(0,0),y.x=A.x+z.x,y.y=A.y+z.y,y);B.fillStyle=bD(this.La,this.Ka,this.Ja,this.va);B.beginPath();B.moveTo(r.x,r.y);B.lineTo(n.x,n.y);B.lineTo(g.x,g.y);B.closePath();B.fill();break;case 2:A=Math.cos(this.kb)*this.lb;z=Math.sin(this.kb)*this.lb;B.strokeStyle=bD(this.La,this.Ka,this.Ja,this.va);B.beginPath();B.moveTo(this.Q.x-A,this.Q.y-z);B.lineTo(this.Q.x+A,this.Q.y+z);B.stroke();break;case 3:B.fillStyle=bD(this.La,this.Ka,this.Ja,this.va);B.save();B.translate(this.Q.x,this.Q.y);B.rotate(this.kb);this.kd(B);B.restore()}};dD.prototype.D=function(n,g){this.Eb=Math.round(c5(n,g));return this};dD.prototype.pa=function(){this.mb=0;return this};dD.prototype.Da=function(){this.mb=1;return this};dD.prototype.Db=function(){this.mb=2;return this};dD.prototype.Vd=function(g){this.mb=3;this.kd=g;return this};dD.prototype.color=function(n,g,u,r){this.La=n;this.Ka=g;this.Ja=u;this.va=r;return this};dD.prototype.V=function(n,g,x,w){var u,r=Math.random();this.La=(u=this.La,u+(n-u)*r);this.Ka=(u=this.Ka,u+(g-u)*r);this.Ja=(u=this.Ja,u+(x-u)*r);this.va=(u=this.va,u+(w-u)*r);return this};dD.prototype.h=function(n,g){this.lb=c5(n,g);return this};dD.prototype.ja=function(n,g){this.md=c5(n,g);return this};dD.prototype.I=function(n,g){this.qe=c5(n,g);return this};dD.prototype.F=function(n,g){this.jd=c5(n,g);return this};dD.prototype.expand=function(n,g){this.ld=c5(n,g);return this};dD.prototype.k=function(n,g){this.kb=c5(n,g);return this};dD.prototype.ga=function(n,g){this.hd=c5(n,g);return this};dD.prototype.position=function(g){this.Q=g;return this};dD.prototype.b=function(g){this.Va=g;return this};var dI=function(){function n(){var x=u<w?g[u++]:g[w-1];x.me();return x}for(var g=Array(3000),w=g.length,u=0,r=0;r<g.length;r++){g[r]=new dD}n.reset=function(){u=0};n.B=function(z){for(var y=0;y<u;y++){if(!g[y].B(z)){var x=g[y];g[y]=g[u-1];g[u-1]=x;u--;y--}}};n.e=function(A){for(var z=0;z<u;z++){var y=g[z],x=y.Q;x.x>=V&&x.y>=a&&x.x<=ei&&x.y<=dQ&&y.e(A)}};return n}();c0.prototype.e=function(n,g,y,x,w){if(this.Wa!=cQ.Wa||g<this.ub||x>this.Nb||y<this.vb||w>this.Ob){this.Wa=cQ.Wa;var u=2*(x-g),r=2*(w-y);this.ub=g-u/4;this.vb=y-r/4;this.Nb=x+u/4;this.Ob=w+r/4;x=Math.ceil(u*cH);r=Math.ceil(r*cH);this.canvas.width=Math.max(this.canvas.width,x);this.canvas.height=Math.max(this.canvas.height,r);this.oa.fillStyle="#BFBFBF";this.oa.fillRect(0,0,x,r);this.oa.save();this.oa.translate(x/2,r/2);this.oa.scale(cH,-cH);this.oa.lineWidth=1/cH;this.oa.translate(-(this.ub+this.Nb)/2,-(this.vb+this.Ob)/2);cQ.j.e(this.oa,this.ub,this.vb,this.Nb,this.Ob);this.oa.restore()}n.Ue=p;n.save();n.setTransform(1,0,0,1,0,0);n.drawImage(this.canvas,Math.round((this.ub-g)*cH),Math.round((2*y-w-this.vb)*cH));n.restore()};var eh=l;ez.prototype.e=function(C,B){var A,z,y,x,w=this.i.a(),u=this.r.a(),r=(A=(z=new cV(0,0),z.x=w.x+u.x,z.y=w.y+u.y,z),A.x/=2,A.y/=2,A),n=(A=(y=new cV(0,0),y.x=u.x-w.x,y.y=u.y-w.y,y),z=Math.sqrt(A.x*A.x+A.y*A.y),A.x/=z,A.y/=z,A);n=new cV(this.width/Math.abs(n.x),this.height/Math.abs(n.y));n=Math.min(n.x,n.y)/4;if((A=(z=new cV(0,0),z.x=u.x-w.x,z.y=u.y-w.y,z),A.x*A.x+A.y*A.y)>4*n*n){var g=(A=(z=(x=new cV(0,0),x.x=u.x-w.x,x.y=u.y-w.y,x),y=Math.sqrt(z.x*z.x+z.y*z.y),z.x/=y,z.y/=y,z),A.x*=99,A.y*=99,A);x=(A=new cV(0,0),A.x=g.y,A.y=-g.x,A);g=(A=new cV(0,0),A.x=r.x-w.x,A.y=r.y-w.y,A);if(g.x*g.x+g.y*g.y>n*n){g=(A=(z=new cV(0,0),y=Math.sqrt(g.x*g.x+g.y*g.y),z.x=g.x/y,z.y=g.y/y,z),A.x*=n,A.y*=n,A)}g=(A=new cV(0,0),A.x=g.x+w.x,A.y=g.y+w.y,A);r=(A=new cV(0,0),A.x=r.x-u.x,A.y=r.y-u.y,A);if(r.x*r.x+r.y*r.y>n*n){r=(A=(z=new cV(0,0),y=Math.sqrt(r.x*r.x+r.y*r.y),z.x=r.x/y,z.y=r.y/y,z),A.x*=n,A.y*=n,A)}r=(A=new cV(0,0),A.x=r.x+u.x,A.y=r.y+u.y,A);C.save();dP(C,this.width/2,this.height/2,x);B.jc(C,g,this.width,this.height,this.Rb);C.restore();C.save();dP(C,this.width/2,this.height/2,(A=-1,z=new cV(0,0),z.x=x.x*A,z.y=x.y*A,z));B.jc(C,r,this.width,this.height,this.uc);C.restore();y=Math.min(0.1,((A=(z=new cV(0,0),z.x=u.x-w.x,z.y=u.y-w.y,z),Math.sqrt(A.x*A.x+A.y*A.y))-1.9*n)*0.01);C.save();C.lineWidth=2*y;C.strokeStyle="black";C.beginPath();C.moveTo(-x.x,-x.y);C.lineTo(x.x,x.y);C.stroke();C.restore()}else{B.jc(C,r,this.width,this.height,this.Rb)}};var bL=ez;cB.prototype.Qc=function(n,g){for(var u=0;u<this.O.length;u++){var r=this.O[u];if(r.username==n&&r.levelname==g){return r}}return{username:n,levelname:g,complete:p,gotAllCogs:p}};cB.prototype.Ge=function(n,g,x,w){for(var u=0;u<this.O.length;u++){var r=this.O[u];r.username==n&&r.levelname==g&&this.O.splice(u--,1)}r={username:n,levelname:g,complete:x,gotAllCogs:w};this.O.push(r);if(this.Fc!==o){$.ajax({url:"/stats/",type:"PUT",dataType:"json",data:JSON.stringify(r),contentType:"application/json; charset=utf-8"})}else{n=JSON.stringify(this.O);g=new Date;g.setTime(g.getTime()+157680000000);document.cookie="rapt="+escape(n)+("; expires="+g.toGMTString())+"; path=/"}};var aT=[,,,"CANCEL",,,"HELP",,"BACK SPACE","TAB",,,"CLEAR","RETURN","ENTER",,"SHIFT","CTRL","ALT","PAUSE","CAPS LOCK",,,,,,,"ESCAPE",,,,,"SPACE","PAGE UP","PAGE DOWN","END","HOME","&larr;","&uarr;","&rarr;","&darr;",,,,"PRINT SCREEN","INSERT","DELETE",,"0","1","2","3","4","5","6","7","8","9",,";",,"=",,,,"a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","META",,"CONTEXT MENU",,,"NUMPAD0","NUMPAD1","NUMPAD2","NUMPAD3","NUMPAD4","NUMPAD5","NUMPAD6","NUMPAD7","NUMPAD8","NUMPAD9","*","+","SEPARATOR","-","DECIMAL","DIVIDE","F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12","F13","F14","F15","F16","F17","F18","F19","F20","F21","F22","F23","F24",,,,,,,,,"NUM LOCK","SCROLL LOCK",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,";","=",",","-",".","/",'"',,,,,,,,,,,,,,,,,,,,,,,,,,,"[","\\","]","'",,"META"],c4={ua:{killKey:75,"a-jumpKey":38,"a-crouchKey":40,"a-leftKey":37,"a-rightKey":39,"b-jumpKey":87,"b-crouchKey":83,"b-leftKey":65,"b-rightKey":68},Nc:function(n){for(var g in this.ua){if(n==this.ua[g]){return g}}return o},ne:function(g){g=cM(aT[g]||"&iquest;").replace(" ","<br>");if(g.charAt(0)!="&"&&g.length>1){g='<div style="'+(g.indexOf("<br>")!=-1?"padding-top:10px;line-height:15px;":"")+"font-size:"+(g.length<=3?25:g.length<=5?18:15).toFixed()+'px;">'+g+"</div>"}return g},load:function(){for(var n in this.ua){var g=parseInt,y;n:{y=n;if(typeof localStorage!="undefined"){y=localStorage.hasOwnProperty(y)?localStorage[y]:""}else{for(var x=document.cookie.split(";"),w=0;w<x.length;w++){var u=x[w],r=u.indexOf("=");if(r!=-1&&u.substring(0,r).replace(/ /g,"")==y){y=u.substring(r+1);break n}}y=""}}g=g(y,10);isNaN(g)||(this.ua[n]=g)}this.Gd()},save:function(){for(var n in this.ua){var g=n,u=this.ua[n];if(typeof localStorage!="undefined"){localStorage[g]=u}else{var r=new Date;r.setTime(r.getTime()+157680000000);document.cookie=g+"="+u+"; expires="+r.toGMTString()+"; path=/"}}this.Gd()},Gd:function(){for(var g in this.ua){$("#"+g).html(this.ne(this.ua[g]))}}};Function.prototype.t=function(g){$.extend(this.prototype,g.prototype)};dk.prototype.pe=function(n){this.O=[0,0,0,0];this.j=new dA(n.width,n.height,cG(n.start),cG(n.end));for(var g=0;g<n.width;g++){for(var u=0;u<n.height;u++){var r=n.cells[u][g];this.j.Ee(g,u,r);if(r!==dm){this.j.Ad=new cV(g+0.5,u+0.5)}}}this.j.Td();this.i.reset(this.j.ma,bZ);this.r.reset(this.j.ma,bB);for(g=0;g<n.entities.length;++g){u=n.entities[g];switch(u["class"]){case"cog":this.S.push(new c2(cG(u.pos)));break;case"wall":cQ.sc(cG(u.end),cG(u.start),u.oneway?bU:aC,u.color,u.open);break;case"button":r=new bl(cG(u.pos),u.type,l);r.Ga=u.walls;this.S.push(r);break;case"sign":this.S.push(new aZ(cG(u.pos),u.text));break;case"enemy":this.S.push(cp(u))}}};var bU=0,aC=1;eg.prototype.Vb=function(n){if(this.s[n]===o){return p}var g=this.cells[n];return g!==o&&g.Oc(this.s[n])!==-1};eg.prototype.Hc=function(n,g){if(this.s[n]!==o&&!this.Vb(n)){var r=this.cells[n];if(r!==o){r.Id(new dE(this.s[n].C.start,this.s[n].C.end,this.s[n].color));g&&cQ.oe(this.s[n]);cQ.wd()}}};eg.prototype.Ic=function(n){if(this.s[n]!==o&&this.Vb(n)){var g=this.cells[n];if(g!==o){g.Be(this.s[n]);cQ.wd()}}};eg.prototype.rc=function(n,g,r){for(g=0;g<2;++g){switch(n){case ai:this.Ic(g);break;case by:this.Hc(g,r);break;case e:this.Vb(g)?this.Ic(g):this.Hc(g,r)}}};var ek=0,b3=1,cx=2,d2=3,aS=4,aA=5,bF=6,aO=7,bK=8,bX=9,et=10,co=11,b7=12,bM=13,cL=14,aE=15,aM=17,eo=19,bT=20,dS=21,aq=22,ex=23,ef=24,c1=25;cK.t(dv);cK.prototype.B=function(n){var g,x,w,u,r;if(this.Pa()){this.la((g=this.b,x=(u=this.Kd(),r=new cV(0,0),r.x=u.x*n,r.y=u.y*n,r),w=new cV(0,0),w.x=g.x+x.x,w.y=g.y+x.y,w))}g={c:this.move(n)};x={c:this.b};w=this.u();u=o;if(this.ba()){u=cN.Ub(this,g,x,this.I,cQ.j,l);this.la(x.c)}w.moveBy(g.c);u!==o&&this.ea(u);cN.Sd(w.a(),cQ.j.ge())||this.w(l);if(!this.l){g=cN.qd(w);for(x=0;x<g.length;++x){g[x].l||this.Z(g[x])}}this.H(n)};cK.prototype.db=N(4);cK.prototype.P=M("type");cK.prototype.L=F();cK.prototype.ba=N(l);cK.prototype.Pa=N(p);cK.prototype.fa=function(n,g){var x,w,u,r;this.la((x=this.b,w=(r=new cV(0,0),r.x=n.x*g,r.y=n.y*g,r),u=new cV(0,0),u.x=x.x+w.x,u.y=x.y+w.y,u));return x=this.b,w=new cV(0,0),w.x=x.x*g,w.y=x.y*g,w};cK.prototype.Kd=function(){var n,g,x,w,u=(n=cQ.j.ma,g=this.a(),x=new cV(0,0),x.x=n.x-g.x,x.y=n.y-g.y,x),r=this.u().h;r=Math.sqrt(u.x*u.x+u.y*u.y)-r;if(r<1){return n=(x=new cV(0,0),w=Math.sqrt(u.x*u.x+u.y*u.y),x.x=u.x/w,x.y=u.y/w,x),g=-100,n.x*=g,n.y*=g,n}else{if(r<1.1){r=100*(1-(r-1)/(1.1-1));return n=(x=new cV(0,0),w=Math.sqrt(u.x*u.x+u.y*u.y),x.x=u.x/w,x.y=u.y/w,x),g=-r,n.x*=g,n.y*=g,n}else{return new cV(0,0)}}};cK.prototype.move=function(){return new cV(0,0)};cK.prototype.ea=F();cK.prototype.Z=function(g){g.w(l)};cK.prototype.H=F();ds.t(cK);ds.prototype.u=M("M");ds.prototype.je=function(){return 1-this.tb/this.Cd};ds.prototype.B=function(g){this.tb-=g;if(this.tb<=0){if(this.Oa()){this.tb+=this.Cd}else{this.tb=0}}cK.prototype.B.call(this,g)};ds.prototype.Z=F();ds.prototype.Oa=function(){throw"SpawningEnemy.spawn() unimplemented"};var bG=0.4,bk=0.4,dL=2,c3=1,dF=1;cn.t(ds);cn.prototype.move=function(n){var g,r;return g=this.b,r=new cV(0,0),r.x=g.x*n,r.y=g.y*n,r};cn.prototype.Z=function(n){var g,u,r;if((g=n.a(),u=this.a(),r=new cV(0,0),r.x=g.x-u.x,r.y=g.y-u.y,r).y>bk-0.05){n.la(new cV(n.b.x,6));this.w(l)}else{n.ya?this.w(l):n.w(l)}};cn.prototype.Oa=function(){var g=new cV(this.M.m.x+this.M.$b()*0.5,this.M.m.y);cQ.Ea(new bN(g,new cV(0,Math.min(this.b.y,-0.3))),g);return l};cn.prototype.H=F();cn.prototype.L=function(){bN.prototype.L.call(this);cQ.ra(1)};cn.prototype.e=function(n){var g=this.a();n.strokeStyle="black";n.beginPath();n.moveTo(g.x-0.25,g.y-0.2);n.lineTo(g.x-0.25,g.y-0.1);n.lineTo(g.x-0.1,g.y+0.05);n.lineTo(g.x+0.1,g.y+0.05);n.lineTo(g.x+0.25,g.y-0.1);n.lineTo(g.x+0.25,g.y-0.2);n.arc(g.x,g.y-bk*0.5,aj,0,Math.PI,p);n.lineTo(g.x-0.25,g.y-0.2);n.moveTo(g.x-0.1,g.y+0.05);n.lineTo(g.x-0.2,g.y+0.15);n.moveTo(g.x+0.1,g.y+0.05);n.lineTo(g.x+0.2,g.y+0.15);n.stroke();n.fillStyle="black";n.beginPath();n.arc(g.x,g.y-bk*0.5,aj*this.je(),0,2*Math.PI,p);n.fill()};var dt=0.5,cS=0.5,ct=1;d0.t(ds);d0.prototype.ba=N(p);d0.prototype.De=function(){this.Tb=l};d0.prototype.Oa=function(){var n,g,u;if(this.Tb&&!this.target.l){var r=(n=this.target.a(),g=this.a(),u=new cV(0,0),u.x=n.x-g.x,u.y=n.y-g.y,u);if(Math.sqrt(r.x*r.x+r.y*r.y)<8){if(!cN.Ia(this.a(),this.target.a(),cQ.j)){cQ.Ea(new cv(this.a(),this.target,r.atan2(),this),this.a());this.Tb=p;return l}}}return p};d0.prototype.H=function(){var n,g,r=this.a();if(!this.target.l){this.o.k=(n=this.target.a(),g=new cV(0,0),g.x=r.x-n.x,g.y=r.y-n.y,g).atan2()}this.o.n=r};d0.prototype.e=function(g){this.o.e(g)};var bO=0.5,br=0.5,a5=1.25;a7.t(ds);a7.prototype.ba=N(p);a7.prototype.qc=function(g){return(g.x<0?0:1)+(g.y<0?0:2)};a7.prototype.Oa=function(){for(var n,g,z,y=0;y<4;++y){this.ac[y]=p}var x=p;for(y=0;y<2;++y){var w=cQ.Zb(y),u=this.qc((n=w.a(),g=this.a(),z=new cV(0,0),z.x=n.x-g.x,z.y=n.y-g.y,z)),r=(n=w.a(),g=this.g[u],z=new cV(0,0),z.x=n.x-g.x,z.y=n.y-g.y,z);if(!w.l&&r.x*r.x+r.y*r.y<64&&!cN.Ia(this.g[u],w.a(),cQ.j)){if(!this.ac[u]){cQ.Ea(new bu(this.g[u],r.atan2()),this.g[u]);x=this.ac[u]=l}}}return x};a7.prototype.H=function(n){var g,w,u=this.a(),r=this.g[this.qc((g=cQ.i.a(),w=new cV(0,0),w.x=g.x-u.x,w.y=g.y-u.y,w))];u=this.g[this.qc((g=cQ.r.a(),w=new cV(0,0),w.x=g.x-u.x,w.y=g.y-u.y,w))];n=4*n;this.Ca.tc(r,n);this.Fa.tc(u,n)};a7.prototype.e=function(n){var g,w,u;if(this.Ca.eq(this.Fa)&&!cQ.i.l&&!cQ.r.l){var r=(g=this.Ca,w=this.a(),u=new cV(0,0),u.x=g.x-w.x,u.y=g.y-w.y,u).atan2();n.fillStyle="rgb(205, 0, 0)";n.beginPath();n.arc(this.Ca.x,this.Ca.y,0.1,r,r+Math.PI,p);n.fill();n.fillStyle="rgb(0, 0, 255)";n.beginPath();n.arc(this.Fa.x,this.Fa.y,0.1,r+Math.PI,r+2*Math.PI,p);n.fill()}else{if(!cQ.i.l){n.fillStyle="rgb(205, 0, 0)";n.beginPath();n.arc(this.Ca.x,this.Ca.y,0.1,0,2*Math.PI,p);n.fill()}if(!cQ.r.l){n.fillStyle="rgb(0, 0, 255)";n.beginPath();n.arc(this.Fa.x,this.Fa.y,0.1,0,2*Math.PI,p);n.fill()}}n.strokeStyle="black";n.beginPath();n.moveTo(this.g[0].x,this.g[0].y+0.1);n.lineTo(this.g[1].x,this.g[1].y+0.1);n.moveTo(this.g[0].x,this.g[0].y-0.1);n.lineTo(this.g[1].x,this.g[1].y-0.1);n.moveTo(this.g[2].x,this.g[2].y-0.1);n.lineTo(this.g[3].x,this.g[3].y-0.1);n.moveTo(this.g[2].x,this.g[2].y+0.1);n.lineTo(this.g[3].x,this.g[3].y+0.1);n.moveTo(this.g[0].x+0.1,this.g[0].y);n.lineTo(this.g[2].x+0.1,this.g[2].y);n.moveTo(this.g[0].x-0.1,this.g[0].y);n.lineTo(this.g[2].x-0.1,this.g[2].y);n.moveTo(this.g[1].x-0.1,this.g[1].y);n.lineTo(this.g[3].x-0.1,this.g[3].y);n.moveTo(this.g[1].x+0.1,this.g[1].y);n.lineTo(this.g[3].x+0.1,this.g[3].y);n.stroke();n.beginPath();n.arc(this.g[0].x,this.g[0].y,0.1,0,2*Math.PI,p);n.stroke();n.beginPath();n.arc(this.g[1].x,this.g[1].y,0.1,0,2*Math.PI,p);n.stroke();n.beginPath();n.arc(this.g[2].x,this.g[2].y,0.1,0,2*Math.PI,p);n.stroke();n.beginPath();n.arc(this.g[3].x,this.g[3].y,0.1,0,2*Math.PI,p);n.stroke()};var av=0.5,v=0.5,cC=1.2;bi.t(ds);bi.prototype.ba=N(p);bi.prototype.Oa=function(){var n,g,x,w,u,r=(n=(x=this.target.a(),w=new cV(0,3),u=new cV(0,0),u.x=x.x+w.x,u.y=x.y+w.y,u),g=this.a(),n.x-=g.x,n.y-=g.y,n);n=r.atan2();g=Math.sqrt(r.x*r.x+r.y*r.y);if(!this.target.l&&g<8){if(!cN.Ia(this.a(),this.target.a(),cQ.j)){this.rb=g*0.075;cQ.Ea(new dY(this.a(),n,Math.sqrt(r.x*r.x+r.y*r.y)),this.a());return l}}return p};bi.prototype.H=function(n){var g,x,w,u,r=this.a();if(!this.target.l){this.o.k=(g=(x=this.target.a(),w=new cV(0,3),u=new cV(0,0),u.x=x.x+w.x,u.y=x.y+w.y,u),g.x-=r.x,g.y-=r.y,g).atan2()+Math.PI/2}this.o.n=r;if(this.wa<this.rb){this.wa+=5*n;if(this.wa>=this.rb){this.wa=this.rb;this.rb=0}}else{this.wa-=0.5*n;if(this.wa<=0){this.wa=0}}this.o.nb=new cV(0,this.wa)};bi.prototype.e=function(g){g.fillStyle=this.target==cQ.i?"red":"blue";g.strokeStyle="black";this.o.e(g)};dz.t(cK);dz.prototype.u=M("N");dz.prototype.move=function(n){var g,r;return g=this.b,r=new cV(0,0),r.x=g.x*n,r.y=g.y*n,r};var aY=0.25;bI.t(dz);bI.prototype.move=function(n){var g,y,x,w,u={};if(cN.$a(this,2,{},u,cQ.j)<Number.POSITIVE_INFINITY){u=(g=this.a(),y=u.c,x=new cV(0,0),x.x=g.x-y.x,x.y=g.y-y.y,x);var r=(g=new cV(0,0),g.x=u.y,g.y=-u.x,g);if(this.Lc){this.yb=(g=this.b,g.x*r.x+g.y*r.y)<0?l:p;this.Lc=p}g=this.b=u.x*u.x+u.y*u.y>aY*aY*1.1?this.yb?(g=(x=-1,w=new cV(0,0),w.x=r.x*x,w.y=r.y*x,w),y=(x=new cV(0,0),x.x=u.x*0.9,x.y=u.y*0.9,x),g.x-=y.x,g.y-=y.y,g):(g=(x=new cV(0,0),x.x=u.x*0.9,x.y=u.y*0.9,x),y=new cV(0,0),y.x=r.x-g.x,y.y=r.y-g.y,y):this.yb?(g=(x=-1,w=new cV(0,0),w.x=r.x*x,w.y=r.y*x,w),y=(x=new cV(0,0),x.x=u.x*0.11,x.y=u.y*0.11,x),g.x+=y.x,g.y+=y.y,g):(g=(x=new cV(0,0),x.x=u.x*0.11,x.y=u.y*0.11,x),y=new cV(0,0),y.x=r.x+g.x,y.y=r.y+g.y,y);y=Math.sqrt(g.x*g.x+g.y*g.y);g.x/=y;g.y/=y}return g=this.b,y=1*n,x=new cV(0,0),x.x=g.x*y,x.y=g.y*y,x};bI.prototype.H=function(g){g=1/aY*g;this.o.n=this.a();if(this.yb){this.o.k+=g}else{this.o.k-=g}};bI.prototype.e=function(g){this.o.e(g)};var dO=0.3,dM=1;am.t(dz);am.prototype.move=function(n){var g,u,r=this.Bb();if(!this.Sc&&r){if(this.b.x<3){this.b.x=this.Ie?3:-3;this.Sc=l}}if(r){this.ga=-this.b.x/dO}this.b.y+=aw*n;return g=this.b,u=new cV(0,0),u.x=g.x*n,u.y=g.y*n,u};am.prototype.ea=function(n){var g,w,u;if(dE.qa(n.q)===0){n=this.b.ob(n.q);var r=(g=this.b,w=new cV(0,0),w.x=g.x-n.x,w.y=g.y-n.y,w);this.b=(g=(u=new cV(0,0),u.x=n.x*0.3,u.y=n.y*0.3,u),w=new cV(0,0),w.x=r.x+g.x,w.y=r.y+g.y,w);this.ga=-this.b.x/dO}};am.prototype.H=function(g){this.o.n=this.a();this.o.k+=this.ga*g};am.prototype.e=function(g){this.a();this.o.e(g)};var cl=0.25;c2.t(cK);c2.prototype.u=M("N");c2.prototype.Z=function(){this.w(l)};c2.prototype.L=function(){var n,g,z,y,x;cQ.ca===dN&&cQ.ra(2);for(var w=this.a(),u=0;u<100;++u){var r=cV.G((n=2*Math.PI,0+(n-0)*Math.random()));r=(n=this.b,g=(y=1+4*Math.random(),x=new cV(0,0),x.x=r.x*y,x.y=r.y*y,x),z=new cV(0,0),z.x=n.x+g.x,z.y=n.y+g.y,z);dI().position(w).b(r).h(0.01,1.5).D(0,4).I(0.05,0.9).F(0.01,0.5).color(0.9,0.87,0,1).V(1,0.96,0,1).Da()}};c2.prototype.H=function(g){this.$+=g};c2.prototype.e=function(D){var C=this.a(),B=C.x;C=C.y;var A=this.$;D.save();D.strokeStyle="rgb(255, 245, 0)";D.fillStyle="rgb(255, 245, 0)";D.translate(B,C);D.rotate(A*Math.PI/2);B=cl;C=B*0.8;A=B*0.125;for(var z=B*0.05,y=0;y<2;y++){for(var x=0;x<=y;x++){D.beginPath();for(var w=0;w<=64;w++){var u=(w+0.25)/64*2*Math.PI,r=Math.sin(u),n=Math.cos(u),g=B*0.7;u=B*(1+Math.cos(u*16*0.5)*0.1);if(!y||!x){D.lineTo(n*g,r*g)}if(!y||x){D.lineTo(n*u,r*u)}}D.stroke()}for(w=0;w<5;w++){u=w/5*Math.PI*2;r=Math.sin(u);n=Math.cos(u);D.beginPath();D.lineTo(r*A,-n*A);D.lineTo(-r*A,n*A);D.lineTo(n*C-r*z,r*C+n*z);D.lineTo(n*C+r*z,r*C-n*z);D.fill()}}D.restore()};var ai=0,by=1,e=2,cA=0.4,cj=0.76;bl.t(cK);bl.prototype.u=M("M");bl.prototype.sc=function(g){this.Ga.push(g)};bl.prototype.ba=N(p);bl.prototype.B=function(g){this.qb+=g;if(this.qb>1){this.qb=1}this.oc=p;cK.prototype.B.call(this,g);this.Fd=this.oc};bl.prototype.Z=function(){var n,g,x;this.oc=l;if(!this.Fd){for(var w=0;w<this.Ga.length;++w){cQ.fe(this.Ga[w]).rc(this.Ld,p,l)}for(w=0;w<50;++w){var u=(n=2*Math.PI,0+(n-0)*Math.random()),r=(n=cV.G(u),g=3+2*Math.random(),x=new cV(0,0),x.x=n.x*g,x.y=n.y*g,x);dI().position(this.a()).b(r).k(u).h(0.05).D(3).I(0.5).F(0.01).Db().color(1,1,1,1)}this.qb=0}};bl.prototype.e=function(A){var z,y,x,w;if(this.Qe){var u=this.a(),r=this.Ce+2*Math.PI/3/(this.qb+0.1);A.fillStyle="white";A.strokeStyle="black";A.beginPath();A.arc(u.x,u.y,0.11,0,2*Math.PI,p);A.fill();A.stroke();A.beginPath();for(var n=0;n<3;++n){A.moveTo(u.x,u.y);var g=(z=(x=cV.G(r+(n-0.5)*(2*Math.PI/3)),w=new cV(0,0),w.x=x.x*0.11,w.y=x.y*0.11,w),y=new cV(0,0),y.x=u.x+z.x,y.y=u.y+z.y,y);A.lineTo(g.x,g.y)}A.stroke()}};var aU=1.5,bA=0.76,bh=0.76;aZ.t(cK);aZ.prototype.He=function(A,z){var y=z.split(" "),x=[],w="";A.font="12px sans serif";for(var u=this.Je*cH,r=0,n=0;n<y.length;++n){var g=y[n];r=A.measureText(w+g).width;if(r<u){w+=" "+g}else{w.length>0&&x.push(w);w=g}if(n==y.length-1){x.push(w);break}}return x};aZ.prototype.u=M("M");aZ.prototype.ba=N(p);aZ.prototype.B=function(g){this.$+=g;this.Wb=p;cK.prototype.B.call(this,g)};aZ.prototype.Z=function(){this.Wb=l};aZ.prototype.e=function(n){if(this.Mb===o){this.Mb=this.He(n,this.text)}var g=this.a();n.save();n.textAlign="center";n.scale(1/cH,-1/cH);n.save();n.font="bold 34px sans-serif";n.lineWidth=1;n.fillStyle="yellow";n.strokeStyle="black";n.translate(g.x*cH,-g.y*cH+12);var r=this.$-Math.floor(this.$);r=Math.cos(r*2*Math.PI)/16+1;n.scale(r,r);n.fillText("?",0,0);n.strokeText("?",0,0);n.restore();this.Wb&&cO(n,this.Mb,g.x*cH,-(g.y+0.5)*cH-15*this.Mb.length/2,13);n.restore()};var ak=0.4,h=0.4,bY=0.2,c8=3,aH=0,d4=1;aX.t(ds);aX.prototype.ba=N(p);aX.prototype.Oa=function(){cQ.Ea(new bR(this.a(),this.direction),this.a());return l};aX.prototype.H=function(n){var g,w;this.Hb+=n*(0.5/bY);n=this.Hb*(2*Math.PI/c8);var u=this.direction-Math.PI/2,r=(g=cV.G(u),w=new cV(0,0),w.x=g.x*0.2,w.y=g.y*0.2,w);w=this.a();this.d[aH].k=u+n;this.d[d4].k=u-n;this.d[aH].n=(g=new cV(0,0),g.x=w.x-r.x,g.y=w.y-r.y,g);this.d[d4].n=(g=new cV(0,0),g.x=w.x+r.x,g.y=w.y+r.y,g);c8&1||(this.d[d4].k+=Math.PI/c8)};aX.prototype.e=function(D){var C,B,A,z,y;this.d[aH].e(D);this.d[d4].e(D);var x=this.Hb*(2*Math.PI/c8),w=this.direction-Math.PI/2,u=this.a();w=(C=cV.G(w),B=new cV(0,0),B.x=C.x*0.2,B.y=C.y*0.2,B);D.fillStyle="yellow";D.strokeStyle="black";for(var r=-1;r<=1;r+=2){for(var n=0;n<c8;n++){var g=n*(2*Math.PI/c8)-r*x,E=(this.Hb-n*r)/c8+(r==1)*0.5;if(r==1&&!(c8&1)){g+=Math.PI/c8;E-=0.5/c8}E-=Math.floor(E);g=(C=(A=(y=new cV(0,0),y.x=w.x*r,y.y=w.y*r,y),z=new cV(0,0),z.x=u.x+A.x,z.y=u.y+A.y,z),B=w.rotate(g),C.x+=B.x,C.y+=B.y,C);D.beginPath();D.arc(g.x,g.y,0.1*E,0,2*Math.PI,p);D.fill();D.stroke()}}};j.t(cK);j.prototype.u=M("N");var dW=0.3;ax.t(j);ax.prototype.Pa=function(){return this.xb?p:l};ax.prototype.move=function(n){var g,w,u;g=this.b;w=Math.pow(0.818566804688,n);g.x*=w;g.y*=w;if(!this.target||this.target.l){this.xb=p;return this.fa((g=this.b,w=-0.8,u=new cV(0,0),u.x=g.x*w,u.y=g.y*w,u),n)}var r=(g=this.target.a(),w=this.a(),u=new cV(0,0),u.x=g.x-w.x,u.y=g.y-w.y,u);if(r.x*r.x+r.y*r.y>100){this.xb=p;return this.fa((g=this.b,w=-0.8,u=new cV(0,0),u.x=g.x*w,u.y=g.y*w,u),n)}this.xb=l;g=Math.sqrt(r.x*r.x+r.y*r.y);r.x/=g;r.y/=g;return this.fa((g=new cV(0,0),g.x=r.x*6,g.y=r.y*6,g),n)};ax.prototype.L=function(){cQ.ra(1)};ax.prototype.H=function(){var n,g,r=this.a();this.o.n=r;if(!this.target.l){this.o.k=(n=this.target.a(),g=new cV(0,0),g.x=n.x-r.x,g.y=n.y-r.y,g).atan2()-Math.PI/2}};ax.prototype.e=function(g){g.fillStyle=this.target==cQ.i?"red":"blue";g.strokeStyle="black";this.o.e(g)};var eq=0.15,bn=0,em=eq*0.5;bW.prototype.B=function(n,g){var w=this.za.x-g.x*cH,u=this.za.y-g.y*cH,r=Math.min(1,Math.sqrt(w*w+u*u)/em);for(w=Math.atan2(u,w)-this.k;w<-Math.PI;){w+=Math.PI*2}for(;w>Math.PI;){w-=Math.PI*2}this.k+=600*(Math.random()-0.5)*n*(1-r*0.8)+(Math.PI-Math.abs(w))/Math.PI*r*(w>0?-2:2);this.k-=Math.floor(this.k/(Math.PI*2))*Math.PI*2;this.za.x+=600*Math.cos(this.k)*n;this.za.y+=600*Math.sin(this.k)*n;this.Ma.push(new cV(this.za.x,this.za.y));this.Ma.length>15&&this.Ma.shift()};bW.prototype.e=function(n){for(var g=1;g<this.Ma.length;g++){var u=this.Ma[g-1],r=this.Ma[g];n.strokeStyle="rgba(0, 0, 0, "+(g/this.Ma.length).toFixed(3)+")";n.beginPath();n.moveTo(u.x/cH,u.y/cH);n.lineTo(r.x/cH,r.y/cH);n.stroke()}};b1.t(j);b1.prototype.move=function(n){var g,y,x,w,u;this.cd=p;if(this.Zc){this.target.l&&this.w(l);r=(g=(x=this.target.a(),w=new cV(0,0.45),u=new cV(0,0),u.x=x.x+w.x,u.y=x.y+w.y,u),y=this.a(),g.x-=y.x,g.y-=y.y,g);if(this.target.crouchKey&&this.target.Bb()){r.y-=0.25;if(this.target.ia){r.x+=0.15}else{r.x-=0.15}}this.N.moveBy(r)}else{if(this.target.l){return new cV(0,0)}var r=(g=this.target.a(),y=this.a(),x=new cV(0,0),x.x=g.x-y.x,x.y=g.y-y.y,x);if(r.x*r.x+r.y*r.y<36&&!cN.Ia(this.a(),this.target.a(),cQ.j)){r.y+=0.45;if(r.x*r.x+r.y*r.y>3*n*3*n*3){this.cd=l;g=Math.sqrt(r.x*r.x+r.y*r.y);r.x/=g;r.y/=g;r=(g=3*n,y=new cV(0,0),y.x=r.x*g,y.y=r.y*g,y)}else{this.Zc=l}return r}}return new cV(0,0)};b1.prototype.ea=F();b1.prototype.L=function(){var n,g,x,w;cQ.ra(1);var u=this.a(),r=(n=cV.G((w=2*Math.PI,0+(w-0)*Math.random())),g=0+0.05*Math.random(),x=new cV(0,0),x.x=n.x*g,x.y=n.y*g,x);r=dI().position(u).b(r).h(eq).D(3).I(0.5).F(0.01).pa().ja(5);this.target==cQ.i?r.color(1,0,0,1):r.color(0,0,1,1);for(w=0;w<50;++w){u=(n=2*Math.PI,0+(n-0)*Math.random());r=(n=cV.G(u),g=3+2*Math.random(),x=new cV(0,0),x.x=n.x*g,x.y=n.y*g,x);dI().position(this.a()).b(r).k(u).h(0.05).D(3).I(0.5).F(0.01).Db().color(0,0,0,1)}};b1.prototype.Z=function(g){if(g===this.target){g.Xd()}else{g.b.y<0&&g.a().y>this.a().y&&this.w(l)}};b1.prototype.H=function(n){for(var g=this.a(),r=0;r<this.Za.length;r++){this.Za[r].B(n,g)}};b1.prototype.e=function(n){var g=this.a();n.strokeStyle="black";for(var r=0;r<this.Za.length;r++){this.Za[r].e(n)}n.fillStyle=this.target==cQ.i?"red":"blue";n.beginPath();n.arc(g.x,g.y,eq*0.75,0,Math.PI*2,p);n.fill();n.stroke()};c7.t(cK);c7.prototype.u=M("N");var dw=0,cU=1,an=2.5,c6=0.15,a1=1,aK=0.3;cW.t(c7);cW.prototype.wc=function(n){var g,w,u;if(!this.target.l){var r=(g=this.target.a(),w=this.a(),u=new cV(0,0),u.x=g.x-w.x,u.y=g.y-w.y,u).atan2();this.U=b5(this.U,r,this.re*n)}};cW.prototype.move=function(n){var g,r;if(this.Ed<=0){this.wc(n);this.b=new cV(an*Math.cos(this.U),an*Math.sin(this.U))}else{this.Ed-=n}return g=this.b,r=new cV(0,0),r.x=g.x*n,r.y=g.y*n,r};cW.prototype.H=function(n){var g,z,y,x,w,u,r=this.a();this.d[dw].n=r;this.d[cU].n=r;this.d[dw].k=this.U;this.d[cU].k=this.U;r=(g=(y=(x=this.b,w=new cV(0,0),u=Math.sqrt(x.x*x.x+x.y*x.y),w.x=x.x/u,w.y=x.y/u,w),y.x*=c6,y.y*=c6,y),z=new cV(0,0),z.x=r.x-g.x,z.y=r.y-g.y,z);for(this.nc-=n;this.nc<=0&&!this.l;){n=cV.G((g=2*Math.PI,0+(g-0)*Math.random()));n=(g=(y=0+2*Math.random(),x=new cV(0,0),x.x=n.x*y,x.y=n.y*y,x),z=(y=this.b,x=new cV(0,0),x.x=y.x*3,x.y=y.y*3,x),g.x-=z.x,g.y-=z.y,g);dI().position(r).b(n).h(0.1,0.15).D(1).F(0.000001,0.00001).expand(1,1.2).color(1,0.5,0,1).V(1,1,0,1).Da();n=cV.G((g=2*Math.PI,0+(g-0)*Math.random()));n=(g=(y=0.25+0.75*Math.random(),x=new cV(0,0),x.x=n.x*y,x.y=n.y*y,x),z=this.b,g.x-=z.x,g.y-=z.y,g);dI().position(r).b(n).h(0.05,0.1).D(1).I(0.05,0.9).F(0.0005,0.001).expand(1.2,1.4).color(0,0,0,0.25).V(0.25,0.25,0.25,0.75).pa().ja(-0.4,0);this.nc+=0.03}};cW.prototype.ea=function(){this.w(l)};cW.prototype.Z=function(g){this.w(l);g.w(l)};cW.prototype.L=function(){for(var n,g,w=this.a(),u=0;u<50;++u){var r=cV.G((n=2*Math.PI,0+(n-0)*Math.random()));r=(n=0.5+16.5*Math.random(),g=new cV(0,0),g.x=r.x*n,g.y=r.y*n,g);dI().position(w).b(r).h(0.02,0.15).D(0,4).I(0.05,0.9).F(0.00001,0.0001).expand(1,1.2).color(1,0.5,0,1).V(1,1,0,1).Da()}};cW.prototype.e=function(g){this.d[this.target==cQ.i?dw:cU].e(g)};var m=0.3;ey.t(c7);ey.prototype.move=function(n){var g,y,x;if(this.target.l){this.b.x=this.b.y=0;return g=this.b,y=new cV(0,0),y.x=g.x*n,y.y=g.y*n,y}else{var w=(g=this.target.a(),y=this.a(),x=new cV(0,0),x.x=g.x-y.x,x.y=g.y-y.y,x),u={},r=cN.$a(this,5,{},u,cQ.j);if(r<0.001){return this.fa(new cV(0,0),n)}this.R=(g=new cV(0,0),y=Math.sqrt(w.x*w.x+w.y*w.y),g.x=w.x/y,g.y=w.y/y,g);if(r<Number.POSITIVE_INFINITY){w=(g=u.c,y=this.a(),x=new cV(0,0),x.x=g.x-y.x,x.y=g.y-y.y,x);x=(g=-1/(r*r),y=new cV(0,0),y.x=w.x*g,y.y=w.y*g,y);g=this.R;g.x+=x.x;g.y+=x.y}g=this.R;y=Math.sqrt(g.x*g.x+g.y*g.y);g.x/=y;g.y/=y;g=this.R;g.x*=3.3;g.y*=3.3;g=this.b;y=Math.pow(0.366032,n);g.x*=y;g.y*=y;return this.fa(this.R,n)}};ey.prototype.ea=function(){this.w(l)};ey.prototype.L=function(){var n,g;cQ.ra(1);for(var w=this.a(),u=0;u<50;++u){var r=cV.G((n=2*Math.PI,0+(n-0)*Math.random()));r=(n=0.5+16.5*Math.random(),g=new cV(0,0),g.x=r.x*n,g.y=r.y*n,g);dI().position(w).b(r).h(0.02,0.15).D(0,4).I(0.05,0.9).F(0.000001,0.00001).expand(1,1.2).color(1,0.3,0,1).V(1,0.1,0,1).Da()}};ey.prototype.H=function(n){var g,r;this.o.n=this.a();this.ga=(this.ga+(g=-Math.PI,r=Math.PI,g+(r-g)*Math.random()))*0.5;this.o.k+=this.ga*n};ey.prototype.e=function(g){g.fillStyle=this.target==cQ.i?"red":"blue";g.strokeStyle="black";this.o.e(g)};var b=0,bg=1,k=2,d6=0.3,dH=0.4,bz=0;bE.t(c7);bE.prototype.Pa=N(l);bE.prototype.wb=function(A){var z,y,x,w,u,r,n,g;return z=(y=(w=(r=new cV(0,0),n=Math.sqrt(A.x*A.x+A.y*A.y),r.x=A.x/n,r.y=A.y/n,r),u=(r=this.b,n=3/14,g=new cV(0,0),g.x=r.x*n,g.y=r.y*n,g),w.x-=u.x,w.y-=u.y,w),x=Math.sqrt(y.x*y.x+y.y*y.y),y.x/=x,y.y/=x,y),z.x*=14,z.y*=14,z};bE.prototype.Xa=function(n,g){if(n.l){return p}var r=g<64;r&=!cN.Ia(this.a(),n.a(),cQ.j);return r};bE.prototype.move=function(D){var C,B,A,z,y,x,w=(C=cQ.i.a(),B=this.a(),A=new cV(0,0),A.x=C.x-B.x,A.y=C.y-B.y,A),u=(C=cQ.r.a(),B=this.a(),A=new cV(0,0),A.x=C.x-B.x,A.y=C.y-B.y,A),r=(C=(A=cQ.i.b,z=20*D,y=new cV(0,0),y.x=A.x*z,y.y=A.y*z,y),B=new cV(0,0),B.x=w.x+C.x,B.y=w.y+C.y,B),n=(C=(A=cQ.r.b,z=20*D,y=new cV(0,0),y.x=A.x*z,y.y=A.y*z,y),B=new cV(0,0),B.x=u.x+C.x,B.y=u.y+C.y,B),g=w.x*w.x+w.y*w.y,H=u.x*u.x+u.y*u.y,G=this.Xa(cQ.i,g),E=this.Xa(cQ.r,H);if(G){if(E){if((C=this.b,w.x*C.x+w.y*C.y)*(C=this.b,u.x*C.x+u.y*C.y)>=0){this.R=(C=(A=(y=new cV(0,0),x=Math.sqrt(w.x*w.x+w.y*w.y),y.x=w.x/x,y.y=w.y/x,y),z=(y=new cV(0,0),x=Math.sqrt(u.x*u.x+u.y*u.y),y.x=u.x/x,y.y=u.y/x,y),A.x+=z.x,A.y+=z.y,A),B=-1.5,C.x*=B,C.y*=B,C);this.target=o;this.z=3}else{if(g<H){this.R=this.wb(r);this.target=cQ.i;this.z=1}else{this.R=this.wb(n);this.target=cQ.r;this.z=2}}}else{this.R=this.wb(r);this.target=cQ.i;this.z=1}}else{if(E){this.R=this.wb(n);this.target=cQ.r;this.z=2}else{this.R.x=this.R.y=0;this.target=o;this.z=bz}}C=this.b;B=Math.pow(0.366032,D);C.x*=B;C.y*=B;return this.fa(this.R,D)};bE.prototype.H=function(n){var g,w,u=this.a();this.d[b].n=u;if(this.target){var r=this.d[b].k;u=(g=this.target.a(),w=new cV(0,0),w.x=g.x-u.x,w.y=g.y-u.y,w).atan2()-Math.PI/2;this.d[b].k=b5(r,u,Math.PI*n)}this.Cb=b5(this.Cb,this.target?-0.2:0,0.4*n);this.d[bg].k=this.Cb;this.d[k].k=this.Cb};bE.prototype.e=function(n){var g,z,y,x;n.fillStyle=this.target==cQ.i?"red":"blue";n.strokeStyle="black";if(this.z!=bz){var w=this.d[b].k+Math.PI/2,u=cV.G(w),r=(g=this.a(),z=(x=new cV(0,0),x.x=u.x*0.2,x.y=u.y*0.2,x),y=new cV(0,0),y.x=g.x-z.x,y.y=g.y-z.y,y);if(this.z==1){n.fillStyle="red";n.beginPath();n.arc(r.x,r.y,0.1,0,2*Math.PI,p);n.fill()}else{if(this.z==2){n.fillStyle="blue";n.beginPath();n.arc(r.x,r.y,0.1,0,2*Math.PI,p);n.fill()}else{n.fillStyle="red";n.beginPath();n.arc(r.x,r.y,0.1,w,w+Math.PI,p);n.fill();n.fillStyle="blue";n.beginPath();n.arc(r.x,r.y,0.1,w+Math.PI,w+2*Math.PI,p);n.fill();n.beginPath();n.moveTo(r.x-u.x*0.1,r.y-u.y*0.1);n.lineTo(r.x+u.x*0.1,r.y+u.y*0.1);n.stroke()}}}this.d[b].e(n)};var er=4,cX=3,cg=2;cv.t(cW);cv.prototype.move=function(n){var g,r;this.U=this.b.atan2();this.wc(n);this.b=new cV(er*Math.cos(this.U),er*Math.sin(this.U));return g=this.b,r=new cV(0,0),r.x=g.x*n,r.y=g.y*n,r};cv.prototype.ea=function(){--this.Tc;if(this.Tc<=0){this.w(l)}else{this.target=cQ.Ab(this.target)}};cv.prototype.w=function(g){dv.prototype.w.call(this,g);g&&this.fd!==o&&this.fd.De()};var aW=0.2;T.t(cK);T.prototype.u=M("N");T.prototype.ba=N(p);T.prototype.H=function(g){this.d[0].n=this.a();this.d[0].k-=g*(25*Math.PI/180);this.d[1].k+=g*(65*Math.PI/180);this.d[2].k+=g*(15*Math.PI/180)};T.prototype.e=function(g){this.d[0].e(g)};var aD=0.45,bf=0.2,bw=1;ej.t(dz);ej.prototype.sd=function(n){if(n.l){return p}var g=Math.abs(n.u().T().m.y-this.N.T().m.y)<0.01;n=n.a().x-this.a().x;return g=g&&Math.abs(n)<1&&this.b.x*n>-0.01};ej.prototype.move=function(n){var g,r;if(this.Bb()){if(this.sd(cQ.i)||this.sd(cQ.r)){this.b.x*=-1}return g=this.b,r=new cV(0,0),r.x=g.x*n,r.y=g.y*n,r}else{return this.fa(new cV(0,aw),n)}};ej.prototype.ea=function(n){var g,y,x,w,u;if(dE.qa(n.q)===0){n=this.b.ob(n.q);var r=(g=this.b,y=new cV(0,0),y.x=g.x-n.x,y.y=g.y-n.y,y);this.b=(g=(x=(w=new cV(0,0),u=Math.sqrt(r.x*r.x+r.y*r.y),w.x=r.x/u,w.y=r.y/u,w),x.x*=dZ,x.y*=dZ,x),y=(x=new cV(0,0),x.x=n.x*0.1,x.y=n.y*0.1,x),g.x+=y.x,g.y+=y.y,g)}};ej.prototype.Z=function(){this.Hd.moveTo(this.N.a());cN.qd(this.Hd).length===0&&this.w(l)};ej.prototype.w=function(g){this.body.w(g);dv.prototype.w.call(this,g)};ej.prototype.L=function(){var n,g;cQ.ra(1);for(var y=this.a(),x=0;x<16;++x){var w=cV.G((n=2*Math.PI,0+(n-0)*Math.random()));w=(n=0.5+4.5*Math.random(),g=new cV(0,0),g.x=w.x*n,g.y=w.y*n,g);var u=(n=2*Math.PI,0+(n-0)*Math.random()),r=(n=-Math.PI,g=Math.PI,n+(g-n)*Math.random());dI().position(y).b(w).h(0.25).D(3).I(0.5).F(0.01).Db().k(u).ga(r).color(0,0,0,1)}};ej.prototype.e=F();var aF=0.5;bQ.t(c7);bQ.prototype.ba=N(p);bQ.prototype.Pa=N(l);bQ.prototype.move=function(n){var g,w,u;if(!this.target){return new cV(0,0)}var r=(g=this.target.a(),w=this.a(),u=new cV(0,0),u.x=g.x-w.x,u.y=g.y-w.y,u);this.U=b5(this.U,r.atan2(),7);u=7*n;this.b.x+=u*Math.cos(this.U);this.b.y+=u*Math.sin(this.U);if((g=this.b,g.x*g.x+g.y*g.y)>0.7*0.7){g=this.b;w=Math.sqrt(g.x*g.x+g.y*g.y);g.x/=w;g.y/=w;g=this.b;g.x*=0.7;g.y*=0.7}return g=this.b,w=new cV(0,0),w.x=g.x*n,w.y=g.y*n,w};bQ.prototype.H=function(){var n,g,y,x,w,u=cV.G((n=2*Math.PI,0+(n-0)*Math.random()));u=(n=this.a(),g=(x=0+(aF-0)*Math.random(),w=new cV(0,0),w.x=u.x*x,w.y=u.y*x,w),y=new cV(0,0),y.x=n.x+g.x,y.y=n.y+g.y,y);w=this.target===cQ.i?0.4:0;var r=this.target===cQ.r?0.3:0;this.Kb=(n=(y=this.Kb,x=new cV(0,0),x.x=y.x*0.95,x.y=y.y*0.95,x),g=(y=this.b,x=new cV(0,0),x.x=y.x*0.05,x.y=y.y*0.05,x),n.x+=g.x,n.y+=g.y,n);dI().position(u).b((n=this.Kb,g=new cV(0.1,0.1),y=new cV(0,0),y.x=n.x-g.x,y.y=n.y-g.y,y),(n=this.Kb,g=new cV(0.1,0.1),y=new cV(0,0),y.x=n.x+g.x,y.y=n.y+g.y,y)).h(0.01,0.1).D(0,4).I(0.05,0.9).F(0.01,0.5).expand(1,1.2).color(0.2+w,0.2,0.2+r,1).V(0.1+w,0.1,0.1+r,1).pa().ja(-0.4,0)};bQ.prototype.e=F();var ag=0.3,c=0.5,dU=2*Math.PI;bt.t(c7);bt.prototype.Pa=N(l);bt.prototype.xc=function(n){var g,u,r;if(n.l){return new cV(0,0)}n=(g=n.a(),u=this.a(),r=new cV(0,0),r.x=g.x-u.x,r.y=g.y-u.y,r);if(n.x*n.x+n.y*n.y>100){return new cV(0,0)}g=Math.sqrt(n.x*n.x+n.y*n.y);n.x/=g;n.y/=g;return n};bt.prototype.move=function(D){var C,B,A,z,y,x,w=cQ.i,u=cQ.r,r=this.xc(w),n=this.xc(u);r=(C=(A=new cV(0,0),A.x=r.x+n.x,A.y=r.y+n.y,A),B=new cV(0,0),B.x=C.x*2,B.y=C.y*2,B);n=this.fa(r,D);C=this.b;B=Math.pow(0.547821,D);C.x*=B;C.y*=B;var g=this.a(),G=this.o.k,E=G;if(!w.l&&u.l){E=(C=w.a(),B=new cV(0,0),B.x=C.x-g.x,B.y=C.y-g.y,B).atan2()+Math.PI}else{if(w.l&&!u.l){E=(C=u.a(),B=new cV(0,0),B.x=C.x-g.x,B.y=C.y-g.y,B).atan2()}else{if(!w.l&&!u.l){w=(C=(A=(y=w.a(),x=new cV(0,0),x.x=y.x-g.x,x.y=y.y-g.y,x),z=A.x,A.x=A.y,A.y=-z,A),B=(A=u.a(),z=new cV(0,0),z.x=A.x-g.x,z.y=A.y-g.y,z),C.x*B.x+C.y*B.y)<0;E=r.atan2()-Math.PI*0.5+Math.PI*w}}}this.o.k=b5(G,E,dU*D);return n};bt.prototype.H=function(){var g=this.a();this.o.n=new cV(g.x,g.y)};bt.prototype.e=function(g){this.o.e(g)};var aw=-6;dB.t(cK);dB.prototype.u=M("N");dB.prototype.e=function(n){var g=this.N.f;n.fillStyle="black";n.beginPath();n.arc(g.x,g.y,this.N.h,0,Math.PI*2,p);n.fill()};dB.prototype.move=function(g){return this.fa(new cV(0,aw),g)};dB.prototype.ea=function(){this.w(l)};dB.prototype.Z=function(g){this.w(l);g.w(l)};var aj=0.15;bN.t(dB);bN.prototype.L=function(){for(var n,g,y,x,w=this.u().a(),u=0;u<50;++u){var r=(n=cV.G((x=2*Math.PI,0+(x-0)*Math.random())),g=0.5+6.5*Math.random(),y=new cV(0,0),y.x=n.x*g,y.y=n.y*g,y);dI().position(w).b(r).h(0.02,0.15).D(0,4).I(0.05,0.9).F(0.00001,0.0001).expand(1,1.2).color(1,0.5,0,1).V(1,1,0,1).Da()}dI().position(w).h(0.1).D(0).ja(p).F(0.000001).expand(10).color(1,1,1,5).pa()};var dg=0.2,b9=0,f=1,en=2;aG.t(dB);aG.prototype.move=function(n){if(this.ad){return dB.prototype.move.call(this,n)}else{if(this.target!==o&&!this.target.l){var g=this.target.a(),r=this.a();if(Math.abs(g.x-r.x)<0.1&&g.y<r.y){if(!cN.Ia(r,g,cQ.j)){this.ad=l;return dB.prototype.move.call(this,n)}}}}return new cV(0,0)};aG.prototype.H=function(){var n=this.b.y*-0.25;if(n>1){n=1}var g=this.a();this.d[b9].n=new cV(g.x,g.y+0.1-0.2*n);n=n*Math.PI/2;this.d[f].k=Math.PI-n;this.d[en].k=n-Math.PI/2};aG.prototype.L=function(){var A,z,y,x;cQ.ra(1);for(var w=this.target===cQ.i?0.8:0,u=this.target===cQ.r?1:0,r=this.a(),n=0;n<15;++n){var g=(A=cV.G((x=2*Math.PI,0+(x-0)*Math.random())),z=5+5*Math.random(),y=new cV(0,0),y.x=A.x*z,y.y=A.y*z,y);dI().position(r).b(g).h(0.2).D(3).F(0.01).I(0.5).color(w,0,u,1).Da()}};aG.prototype.e=function(g){g.fillStyle=this.target===cQ.i?"red":"blue";this.d[b9].e(g)};var al=0.1,i=7;bR.t(dB);bR.prototype.Z=function(n){var g,u;if(!this.l){var r=(g=this.b,u=new cV(0,0),u.x=g.x*0.75,u.y=g.y*0.75,u);n.Jd(r)}this.w(l)};bR.prototype.L=function(){for(var n,g,z,y,x,w=this.a(),u=0;u<5;++u){var r=cV.G((n=2*Math.PI,0+(n-0)*Math.random()));r=(n=this.b,g=(y=0.1+0.9*Math.random(),x=new cV(0,0),x.x=r.x*y,x.y=r.y*y,x),z=new cV(0,0),z.x=n.x+g.x,z.y=n.y+g.y,z);dI().position(w).b(r).h(0.01,0.1).D(0,4).I(0.05,0.9).F(0.0005,0.005).expand(1,1.2).color(0.9,0.9,0,1).V(1,1,0,1).pa()}cK.prototype.L.call(this)};bR.prototype.e=function(n){var g=this.a();n.strokeStyle="black";n.fillStyle="yellow";n.beginPath();n.arc(g.x,g.y,al,0,2*Math.PI,p);n.fill();n.stroke()};var dV=0.15,ep=5,b2=0;bu.t(dB);bu.prototype.move=function(n){var g,r;return g=this.b,r=new cV(0,0),r.x=g.x*n,r.y=g.y*n,r};bu.prototype.ea=function(){var n,g;if(this.vc<=0){this.w(l);for(var x=this.a(),w=0;w<20;++w){var u=(n=2*Math.PI,0+(n-0)*Math.random()),r=cV.G(u);r=(n=0.5+4.5*Math.random(),g=new cV(0,0),g.x=r.x*n,g.y=r.y*n,g);dI().position(x).b(r).k(u).h(0.1).D(1).I(1).F(0.01).ja(0).color(1,1,1,1).Db()}}else{--this.vc}};bu.prototype.e=function(n){var g,x,w,u,r=(g=(x=this.b,w=new cV(0,0),u=Math.sqrt(x.x*x.x+x.y*x.y),w.x=x.x/u,w.y=x.y/u,w),g.x*=dV,g.y*=dV,g);w=new dp((g=this.a(),x=new cV(0,0),x.x=g.x-r.x,x.y=g.y-r.y,x),(g=this.a(),x=new cV(0,0),x.x=g.x+r.x,x.y=g.y+r.y,x));n.lineWidth=0.07;n.strokeStyle="white";w.e(n);n.lineWidth=0.02};var dX=5,dj=0.2,dC=0.5;dY.t(dB);dY.prototype.e=function(n){var g=this.u().a(),r=this.mc/dX;n.fillStyle="black";n.beginPath();n.arc(g.x,g.y,(1-r)*dj,0,Math.PI*2,p);n.fill();n.strokeStyle="black";n.beginPath();n.arc(g.x,g.y,dj,0,Math.PI*2,p);n.stroke()};dY.prototype.B=function(g){this.mc-=g;this.mc<=0&&this.w(l);dB.prototype.B.call(this,g)};dY.prototype.ea=F();dY.prototype.L=function(){for(var n,g,z,y,x,w=this.a(),u=0;u<100;u++){var r=(n=cV.G((y=2*Math.PI,0+(y-0)*Math.random())),g=1+9*Math.random(),z=new cV(0,0),z.x=n.x*g,z.y=n.y*g,z);dI().position(w).b(r).h(0.1,0.2).D(0,4).I(0.05,0.9).F(0.0001,0.001).expand(1,1.2).color(1,0.25,0,1).V(1,0.5,0,1).Da()}for(u=0;u<50;u++){r=cV.G((n=2*Math.PI,0+(n-0)*Math.random()));r=(n=new cV(0,1),g=(y=0.25+0.75*Math.random(),x=new cV(0,0),x.x=r.x*y,x.y=r.y*y,x),z=new cV(0,0),z.x=n.x+g.x,z.y=n.y+g.y,z);dI().position(w).b(r).h(0.1,0.2).D(1,3).I(0.05,0.9).F(0.0005,0.1).expand(1.1,1.3).color(0,0,0,1).V(0.5,0.5,0.5,1).pa().ja(-0.4,0)}};var cH=50,cq=6,b4=6,K=1/60;aI.t(function(){this.B=F();this.e=F();this.resize=F();this.Qa=F();this.Ra=F()});aI.prototype.resize=function(n,g){this.width=n;this.height=g;this.yc=new bL(cQ.i,cQ.r,n/cH,g/cH)};aI.prototype.B=function(n){var g,u,r=0;for(this.Xb+=n;++r<=3&&this.Xb>=0;){this.Xb-=K;cQ.B(K);dI.B(K)}this.Yb=(g=this.Yb,u=1/n,g+(u-g)*0.05);if(!this.$c&&cQ.ca!=dN){this.$c=l;cQ.ca==1&&this.hc&&this.hc()}};aI.prototype.jc=function(n,g,y,x,w){var u=y/2,r=x/2;x=g.x-u;y=g.y-r;u=g.x+u;r=g.y+r;n.save();n.translate(-g.x,-g.y);w?w.e(n,x,y,u,r):cQ.j.e(n,x,y,u,r);cQ.e(n,x,y,u,r);dI.e(n);n.restore()};aI.prototype.e=function(n){if(!eh){n.fillStyle="#BFBFBF";n.fillRect(0,0,this.width,this.height)}n.save();n.translate(this.width/2,this.height/2);n.scale(cH,-cH);n.lineWidth=1/cH;this.yc.e(n,this);n.restore();if(cQ.ca===1){n.save();cO(n,[this.ed?"Congratulations, you beat the last level in this set!\tPress SPACE or ESC to return to the level selection menu.":"You won!  Hit SPACE to play the next level or ESC for the level selection menu.","","Cogs Collected: "+cQ.O[2]+"/"+cQ.O[ck]],this.width/2,this.height/2,14);n.restore()}else{if(cQ.ca===2){n.save();cO(n,["You lost.  Hit SPACE to restart, or ESC to select a new level."],this.width/2,this.height/2,14);n.restore()}}n.font="10px Arial, sans-serif";n.fillStyle="black";var g=this.Yb.toFixed(0)+" FPS";n.fillText(g,this.width-5-n.measureText(g).width,this.height-5)};aI.prototype.Qa=function(n){var g=c4.Nc(n.which);if(g!=o){if(g.indexOf("a-")==0){cQ.i[g.substr(2)]=l}else{if(g.indexOf("b-")==0){cQ.r[g.substr(2)]=l}else{cQ[g]=l}}n.preventDefault();n.stopPropagation()}};aI.prototype.Ra=function(n){var g=c4.Nc(n.which);if(g!=o){if(g.indexOf("a-")==0){cQ.i[g.substr(2)]=p}else{if(g.indexOf("b-")==0){cQ.r[g.substr(2)]=p}else{cQ[g]=p}}n.preventDefault();n.stopPropagation()}};ao.prototype.load=function(n,g){if(!this.sa&&this.A==n){g&&g()}else{if(!(this.sa&&this.A==n)){this.A=n;this.ta=[];this.sa=l;var r=this;bp("menu","http://"+location.host+"/websockets/client/data/"+n+"/",function(x){x=x.user.levels;for(var w=0;w<x.length;w++){var u=x[w];r.ta.push(new d1(u.html_title,u.title,u.difficulty))}r.sa=p;r.selectedIndex=0;g&&g()})}}};ao.prototype.pc=function(){var g=$("#level"+this.selectedIndex);if(g.length>0){$(".level").blur();$(g).focus();g=$("#levelScreen").scrollTop()+$(g).offset().top-475;$("#levelScreen").scrollTop(g)}};ao.prototype.show=function(){if(this.sa){$("#canvas").hide();$("#levelScreen").hide();$("#loadingScreen").show();$("#loadingScreen").html("Loading...")}else{$("#canvas").hide();$("#levelScreen").show();$("#loadingScreen").hide();var n="<h2>";n+=this.A=="rapt"?"Official Levels":"Levels made by "+bq(this.A);n+='</h2><div id="levels">';for(var g=o,x=0;x<this.ta.length;x++){var w=this.ta[x],u=["Easy","Medium","Hard","Brutal","Demoralizing"][w.Wd];if(u!=g){g=u;n+='<div class="difficulty">'+u+"</div>"}n+='<a class="level" id="level'+x+'" href="'+bq(dl.he(this.A,w.J))+'">';u=d9.Qc(this.A,w.J);n+='<img src="/images/'+(u.gotAllCogs?"checkplus":u.complete?"check":"empty")+'.png">';n+=bq(w.title)+"</a>"}n+="</div>";$("#levelScreen").html(n);var r=this;$(".level").hover(function(){$(this).focus()});$(".level").focus(function(){r.selectedIndex=this.id.substr(5)});this.pc()}};ao.prototype.bc=function(n,g){if(n===this.A){for(var r=0;r<this.ta.length;r++){if(g===this.ta[r].J){return r}}}return -1};ao.prototype.bd=function(n,g){return n!==this.A?l:this.bc(n,g)>=this.ta.length-1};ao.prototype.Qa=function(g){if(g.which==38){this.selectedIndex>0&&this.selectedIndex--;this.pc()}else{if(g.which==40){this.selectedIndex<this.ta.length-1&&this.selectedIndex++;this.pc()}}};ao.prototype.Ra=F();cD.prototype.B=function(){var n=new Date,g=(n-this.ec)/1000;this.ec=n;if(this.X!=o){g>0&&g<1&&this.X.B(g);this.X.ed=di.bd(this.A,this.J);this.X.e(this.context)}};cD.prototype.xd=function(){dI.reset();this.X=new aI;this.X.resize(this.canvas.width,this.canvas.height);cQ.pe(this.dd);var g=this;this.X.hc=function(){var n=cQ.O[2]==cQ.O[ck];d9.Ge(g.A,g.J,l,d9.Qc(g.A,g.J).gotAllCogs||n)}};cD.prototype.load=function(n,g,u){this.A=n;this.J=g;this.sa=l;var r=this;bp("level","http://"+location.host+"/websockets/client/data/"+n+"/"+g+"/",function(w){r.dd=JSON.parse(w.level.data);r.xd();r.ec=new Date;r.sa=p;u&&u()})};cD.prototype.show=function(){if(this.sa){$("#canvas").hide();$("#levelScreen").hide();$("#loadingScreen").show();$("#loadingScreen").html("Loading...")}else{$("#canvas").show();$("#levelScreen").hide();$("#loadingScreen").hide()}};cD.prototype.Qa=function(g){if(this.X!=o){this.X.Qa(g);if(g.which==32){if(cQ.ca===2){this.xd()}else{if(cQ.ca===1){di.bd(this.A,this.J)?df.Ib(this.A,o):df.Ib(this.A,di.ta[di.bc(this.A,this.J)+1].J)}}}}};cD.prototype.Ra=function(g){this.X!=o&&this.X.Ra(g)};dl.prototype.ke=function(){if(this.hash!=location.hash){this.ud=this.hash;this.hash=location.hash;var n=/^#\/?([^\/]+)\/([^\/]+)\/?$/.exec(this.hash),g=/^#\/?([^\/]+)\/?$/.exec(this.hash);if(n!=o){this.A=n[1];this.J=n[2]}else{this.A=g!=o?g[1]:o;this.J=o}return l}return p};dl.prototype.Ib=function(n,g){var r="#/"+n+"/"+(g?g+"/":"");if(this.ud===r){history.back()}else{this.A=n;this.J=g;location.hash=r}};dl.Te=function(g){return"#/"+g+"/"};dl.he=function(n,g){return"#/"+n+"/"+g+"/"};var d9=o,df=o,di=o,cw=o,cr=o;$(document).ready(function(){a2();c4.load();df=new dl;di=new ao;cw=new cD;d9=new cB(function(){df.J==o&&di.show()});aL();setInterval(aL,1000/60)});$(".key.changeable").live("mousedown",function(g){cr=this.id;$(".key.changing").removeClass("changing");$("#"+cr).addClass("changing");g.preventDefault();g.stopPropagation()});$(document).keydown(function(g){if(cr!=o){c4.ua[cr]=g.which;c4.save();$("#"+cr).removeClass("changing");g.preventDefault();g.stopPropagation();cr=o}else{if(!g.altKey&&!g.shiftKey&&!g.ctrlKey&&!g.metaKey){di.Qa(g);cw.Qa(g);if(g.which===27){df.Ib(di.A||cw.A,o)}if(g.which==38||g.which==40||g.which==32){g.preventDefault();g.stopPropagation()}}}});$(document).keyup(function(g){if(!g.altKey&&!g.shiftKey&&!g.ctrlKey&&!g.metaKey){di.Ra(g);cw.Ra(g);if(g.which==38||g.which==40||g.which==32){g.preventDefault();g.stopPropagation()}}});cF.prototype.K=function(n){if(this.parent!==o){if(this.parent.firstChild==this){this.parent.firstChild=this.nextSibling}else{for(var g=this.parent.firstChild;g!==o;g=g.nextSibling){if(g.nextSibling==this){g.nextSibling=this.nextSibling}}}}this.nextSibling=o;this.parent=n;if(this.parent!==o){this.nextSibling=this.parent.firstChild;this.parent.firstChild=this}};cF.prototype.e=function(n){n.save();n.translate(this.n.x,this.n.y);this.bb&&n.scale(-1,1);n.rotate(this.k);n.translate(this.nb.x,this.nb.y);this.p(n);for(var g=this.firstChild;g!==o;g=g.nextSibling){g.e(n)}n.restore()};cV.prototype.add=function(g){return new cV(this.x+g.x,this.y+g.y)};cV.prototype.eq=function(g){return Math.abs(this.x-g.x)+Math.abs(this.y-g.y)<0.001};cV.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)};cV.prototype.bb=function(){return new cV(this.y,-this.x)};cV.prototype.atan2=function(){return Math.atan2(this.y,this.x)};cV.prototype.rotate=function(n){var g=Math.sin(n);n=Math.cos(n);return new cV(this.x*n-this.y*g,this.x*g+this.y*n)};cV.prototype.ob=function(n){var g,r;return g=this.x*n.x+this.y*n.y,r=new cV(0,0),r.x=n.x*g,r.y=n.y*g,r};cV.prototype.toString=function(){return"("+this.x.toFixed(3)+", "+this.y.toFixed(3)+")"};cV.prototype.tc=function(B,A){var z,y,x,w,u,r,n,g=(z=(y=new cV(0,0),y.x=B.x-this.x,y.y=B.y-this.y,y),z.x*z.x+z.y*z.y)<A*A?B:(z=(x=(w=(n=new cV(0,0),n.x=B.x-this.x,n.y=B.y-this.y,n),u=new cV(0,0),r=Math.sqrt(w.x*w.x+w.y*w.y),u.x=w.x/r,u.y=w.y/r,u),x.x*=A,x.y*=A,x),y=new cV(0,0),y.x=this.x+z.x,y.y=this.y+z.y,y);this.x=g.x;this.y=g.y};cV.G=function(g){return new cV(Math.cos(g),Math.sin(g))};cV.Ua=function(n,g,y){var x,w,u,r;return x=(u=(r=new cV(0,0),r.x=g.x-n.x,r.y=g.y-n.y,r),u.x*=y,u.y*=y,u),w=new cV(0,0),w.x=n.x+x.x,w.y=n.y+x.y,w};cI.prototype.add=function(){for(var g=0;g<arguments.length;g++){this.xa.push(arguments[g]*Math.PI/180)}return this};cI.prototype.jb=function(n,g){for(var x,w,u=new cI((x=this.f.x,w=n.f.x,x+(w-x)*g),(x=this.f.y,w=n.f.y,x+(w-x)*g)),r=0;r<this.xa.length;r++){u.xa.push((x=this.xa[r],w=n.xa[r],x+(w-x)*g))}return u};cI.Ua=function(n,g){var r=Math.floor(g);g-=r;r%=n.length;return n[r].jb(n[(r+1)%n.length],g)};var at=0.3,a8=0,a4=1,cR=2,cs=3,b6=4,bH=5,s=9,bJ=(new cI(0,0.1)).add(0,-80,-80,80,80,100,100,-100,-100),aB=[(new cI(0,0.2)).add(0,-40,-30,30,40,40,40,-40,-40),(new cI(0,0.1)).add(0,-80,-80,80,80,100,100,-100,-100)],aN=0.4,ev=0.5,bo=0.5;aP.t(dz);aP.prototype.move=function(g){if(this.lc<=0){this.b.y=2.5+4*Math.random();this.b.x=Math.random()>0.5?6.5-this.b.y:-6.5+this.b.y;this.lc=ev;this.gc=p}else{if(this.gc){this.lc-=g}}return this.fa(new cV(0,-6),g)};aP.prototype.ea=function(g){if(g.q.y>=0.999){this.b.x=0;this.b.y=0;this.gc=l}};aP.prototype.H=function(){var n,g,y,x,w=this.a();this.d[a8].n=w;var u={},r={};if(cN.$a(this,2*aN,u,r,cQ.j)<3*aN&&u.c.eq((n=new cV(0,-aN),g=new cV(0,0),g.x=w.x+n.x,g.y=w.y+n.y,g))&&(n=(g=r.c,y=u.c,x=new cV(0,0),x.x=g.x-y.x,x.y=g.y-y.y,x),Math.sqrt(n.x*n.x+n.y*n.y))<0.1){n=bJ}else{n=this.b.y*-0.25;n=n<0?1/(1-n)-1:1-1/(1+n);n=aB[0].jb(aB[1],n)}this.d[a8].nb=n.f;for(g=0;g<s;g++){this.d[g].k=n.xa[g]}};aP.prototype.e=function(g){this.d[a8].e(g)};aP.prototype.Pa=N(l);var dK=0.5,au=0,dG=1,eu=2,d7=3,dJ=4,cZ=5,cz=6,ci=7,cy=8,d3=9,ch=16,cY=17,bm=[(new cI).add(0,-10,-20,-10,10,-10,10,-10,-20,20,10,70,20,70,20,20,10),(new cI).add(0,10,-10,-20,-10,-20,-10,10,-10,20,20,10,70,10,70,20,20),(new cI).add(0,-10,10,-10,-20,-10,-20,-10,10,70,20,20,10,20,10,70,20),(new cI).add(0,-20,-10,10,-10,10,-10,-20,-10,10,70,20,20,20,20,10,70)],ah=[(new cI).add(0,7,3,-1,-5,5,1,-3,-7,-14,-6,2,10,-10,-2,6,14),(new cI).add(0,30,10,-30,-20,30,40,-10,-35,-50,-90,40,20,-50,-40,70,30)],cf=0.9,aQ=0.3,q=2,dZ=1,ar=1;d5.t(ds);d5.prototype.ba=N(p);d5.prototype.Xa=function(n){var g,w,u;if(n.l){return p}var r=(g=n.a(),w=this.a(),u=new cV(0,0),u.x=g.x-w.x,u.y=g.y-w.y,u);g=r.atan2();if(r.y<10&&g>Math.PI*0.25&&g<Math.PI*0.75){return !cN.Ia(this.a(),n.a(),cQ.j)}return p};d5.prototype.Ya=function(n,g,r){cQ.Ea(new cW(n,g,r),this.a())};d5.prototype.Oa=function(){var g=this.a();this.ib=new cV(g.x-cf*0.4,g.y+aQ*0.4);this.pb=new cV(g.x+cf*0.4,g.y+aQ*0.4);if(this.Xa(cQ.i)){if(this.Xa(cQ.r)){this.Ya(this.Sa?this.ib:this.pb,cQ.i,this.Sa?Math.PI*0.75:Math.PI*0.25);this.Ya(this.Sa?this.pb:this.ib,cQ.r,this.Sa?Math.PI*0.25:Math.PI*0.75);this.Sa=!this.Sa}else{this.Ya(this.ib,cQ.i,Math.PI*0.75);this.Ya(this.pb,cQ.i,Math.PI*0.25)}return l}else{if(this.Xa(cQ.r)){this.Ya(this.ib,cQ.r,Math.PI*0.75);this.Ya(this.pb,cQ.r,Math.PI*0.25);return l}}return p};d5.prototype.move=function(){var n,g,w,u,r;return n=(w=this.Ta.a(),u=this.a(),r=new cV(0,0),r.x=w.x-u.x,r.y=w.y-u.y,r),g=new cV(0,0.81-aD+aQ*0.5),n.x+=g.x,n.y+=g.y,n};d5.prototype.H=function(n){var g=this.a();this.d[au].n=g;this.d[au].bb=this.Ta.b.x>0;g=this.Ta.Bb();if(g!=this.Qb){if(++this.Pb>1){this.Qb=g;this.Pb=0}}else{this.Pb=0}this.$+=n*0.5;if(this.Qb){n=cI.Ua(bm,10*this.$)}else{n=this.Ta.b.y*-0.25;n=n<0.01?0:1-1/(1+n);n=ah[0].jb(ah[1],n)}for(g=0;g<cY;g++){this.d[g].k=n.xa[g]}};d5.prototype.Z=function(g){g.w(l)};d5.prototype.L=function(){var n,g;dI().position(this.a()).D(1).ja(5).F(0.1).Vd(d8).color(0,0,0,1).k(0).ga((n=-Math.PI,g=Math.PI,n+(g-n)*Math.random()))};d5.prototype.e=function(g){g.strokeStyle="black";g.fillStyle="black";this.d[au].e(g)};var a0=[(new cI(0,-0.1)).add(5,-10,65,-55,20,40,-20,-30,-30,10),(new cI(0,-0.04)).add(5,-10,35,-25,0,30,18,-110,0,20),(new cI(0,0)).add(5,-10,10,-30,-20,20,60,-100,10,30),(new cI(0,-0.1)).add(5,-10,-20,-30,-30,10,65,-55,20,40),(new cI(0,-0.04)).add(5,-10,18,-110,0,20,35,-25,0,30),(new cI(0,0)).add(5,-10,60,-100,10,30,10,-30,-20,20)],d=[(new cI(0,0)).add(0,-10,150,-170,-40,30,-30,-20,20,150),(new cI(0,0)).add(-20,10,60,-100,-80,30,30,-20,30,30)],el=(new cI(0.1,0)).add(0,-10,150,-130,140,50,50,-30,50,130),aJ=(new cI(0,-0.2)).add(30,-30,130,-110,-30,40,60,-120,20,20),ap=[(new cI(0,0)).add(-20,5,10,-30,-120,-30,40,-20,120,30),(new cI(0,0)).add(-20,5,10,-30,-130,-60,40,-20,150,50)],dT=[(new cI(0.1,0)).add(0,-10,150,-130,140,50,50,-30,50,130),(new cI(0,-0.2)).add(30,-30,160,-180,-30,40,20,-10,20,20)],du=0,bS=1,cT=2,b8=3,t=4,bs=5,cu=6,bP=7,ew=8,a6=9,bx=10;dq.t(dv);dq.prototype.reset=function(n,g){this.rightKey=this.leftKey=this.crouchKey=this.jumpKey=p;this.Aa=new dy(n,new cV(0.1,0.375),new cV(-0.1,0.375),new cV(0,-0.375));this.b=new cV(0,0);this.W=new cV(0,0);this.na=this.ha=this.aa=0;this.dc=this.od=p;this.da=o;this.vd=this.z=0;this.d=bV();this.ia=p;this.sb=this.ab=this.Kc=this.zd=0;this.td=new cV(0,0);this.Lb=this.Jb=0;this.ya=p;this.color=g};dq.prototype.u=M("Aa");dq.prototype.db=M("color");dq.prototype.ie=function(){return this==cQ.r};dq.prototype.Xd=function(){this.dc=l};dq.prototype.Jd=function(n){var g;g=this.b;g.x+=n.x;g.y+=n.y};dq.prototype.Rd=function(){var n,g,x,w,u=cQ.Ab(this);if(u.crouchKey&&!u.l&&this.z==0&&u.z==0){if((n=u.b,n.x*n.x+n.y*n.y)<0.01&&Math.abs(this.b.x)>4){var r=(n=this.a(),g=u.a(),x=new cV(0,0),x.x=n.x-g.x,x.y=n.y-g.y,x);if(Math.abs(r.y)<=0.01&&Math.abs(r.x)<0.1){this.b=new cV(0,10);this.ya=l}}if((n=(g=this.a(),x=u.a(),w=new cV(0,0),w.x=g.x-x.x,w.y=g.y-x.y,w),n.x*n.x+n.y*n.y)<1&&this.ab>1&&u.ab>=this.ab){cQ.Fe(u.a())}}};dq.prototype.B=function(g){this.Me(g);if(!this.l){this.Oe(g);this.Ne(g);this.Le(g)}};dq.prototype.Me=function(n){if(this.l){this.sb+=n}else{this.sb=0}this.sb>3.3&&!cQ.Ab(this).l&&this.w(p);if(this.l){n=cQ.j.ma;var g=(this.sb-2)/1;g=Math.max(0,Math.min(1,g));g=0.5-0.5*Math.cos(g*Math.PI);g=0.5-0.5*Math.cos(g*Math.PI);this.Bd(cV.Ua(this.td,n,g))}};dq.prototype.Oe=function(C){var B,A,z,y;if(this.da!=o){this.ha=this.na=0}this.ha-=C;if(this.ha<0){this.na*=Math.pow(0.1,C)}if(this.da!=o||this.b.y<0){this.ya=p}var x=this.leftKey&&!this.rightKey&&!this.crouchKey,w=this.rightKey&&!this.leftKey&&!this.crouchKey;cN.pd(this,c9,cQ.j);var u=c9.s[0]!=o||this.da!=o&&dE.qa(this.da.q)==0,r=c9.s[1]!=o||this.da!=o&&dE.qa(this.da.q)==1,n=c9.s[2]!=o||this.da!=o&&dE.qa(this.da.q)==2,g=c9.s[3]!=o||this.da!=o&&dE.qa(this.da.q)==3;if(!this.dc&&this.jumpKey){if(u){this.b.y=6.5;this.na=this.aa=this.ha=0;if(r||n){this.ha=0.5;this.aa=1;this.na=0.5}if(n){this.aa=-this.aa}if(cQ.Ab(this).ya){this.b.y=10;this.ya=l}}else{if(r&&!x&&this.ha<0){this.b=new cV(3.5,6.5);this.ha=0.5;this.aa=2.5;this.na=1}else{if(n&&!w&&this.ha<0){this.b=new cV(-3.5,6.5);this.ha=0.5;this.aa=-2.5;this.na=1}}}}if(g){this.na=this.aa=this.ha=0}if(u||!g){if(x){this.b.x-=50*C;this.b.x=Math.max(this.b.x,-8)}if(w){this.b.x+=50*C;this.b.x=Math.min(this.b.x,8)}}this.z=c9.s[0]?0:c9.s[1]?3:c9.s[2]?4:1;x={};w={};u=cN.$a(this,0.1,w,x,cQ.j);if(this.z==3||this.z==4){if(this.b.y<0){this.b.y*=Math.pow(0.1,C)}if(this.b.y>-0.5&&this.vd===2){this.z=2}}if(this.z==1&&u<0.01&&w.c.y>x.c.y){this.z=2}if(this.z==2){if(this.leftKey&&x.c.x-this.Aa.a().x<0){this.b.x-=5*C;this.b.y+=10*C}if(this.rightKey&&x.c.x-this.Aa.a().x>0){this.b.x+=5*C;this.b.y+=10*C}}this.ab+=C;if(!this.crouchKey||this.z!=0){this.ab=0}if(this.z==0){if(this.crouchKey){B=this.b;A=Math.pow(0.000001,C);B.x*=A;B.y*=A}else{this.b.y-=10*C;if(!this.jumpKey&&this.leftKey!=this.rightKey&&this.od&&c9.s[0].C.q.y<0.99){this.b=(B=this.b.ob((z=c9.s[0].C.q,y=new cV(0,0),y.x=z.y,y.y=-z.x,y)),A=new cV(0,0),A.x=B.x*0.99,A.y=B.y*0.99,A);this.b.y+=0.001}}}else{this.b.y-=10*C}this.od=this.z==0&&c9.s[0].C.q.y<0.99;this.Rd();this.W=cV.Ua(this.b,new cV(this.aa,this.b.y),this.na);if(this.aa!=0&&this.b.x/this.aa>1){this.W.x=this.b.x}z=(B=this.W,A=new cV(0,0),A.x=B.x*C,A.y=B.y*C,A);this.b.x*=Math.pow(0.000076,C);A={c:z};C={c:this.b};B=cN.Ub(this,A,C,0,cQ.j,l);z=A.c;this.b=C.c;this.da=B;this.Aa.moveBy(z);if(this.W.y<-15&&B!=o&&B.q.y>0.9){this.w(l);this.L()}this.vd=this.z;this.dc=p};dq.prototype.L=function(){var B,A,z,y,x,w;this.b=new cV(0,0);this.z=1;this.aa=this.na=0;this.ya=p;this.sb=0;this.td=this.Aa.f;var u=cQ.i==this,r=u?1:0.1;u=u?0.1:1;for(var n=0;n<500;n++){var g=cV.G((B=2*Math.PI,A=Math.random(),0+(B-0)*A));g=(B=this.b,A=(y=(w=Math.random(),1+9*w),x=new cV(0,0),x.x=g.x*y,x.y=g.y*y,x),z=new cV(0,0),z.x=B.x+A.x,z.y=B.y+A.y,z);dI().Da().position(this.Aa.f).b(g).h(0.01,0.1).D(0,4).I(0.05,0.9).F(0.01,0.02).expand(1,1.2).color(r/2,0.05,u/2,1).V(r,0.1,u,1)}cQ.ra(0)};dq.prototype.Ne=function(B){var A,z,y,x;if(this.z==3||this.z==4){var w=this.z==4?-1:1,u=this.Aa.T(),r=this.b.y;for(this.Jb-=B*(A=this.b,Math.sqrt(A.x*A.x+A.y*A.y));this.Jb<0;){this.Jb+=0.2;var n=new cV(this.z==4?u.eb():u.m.x,(A=u.m.y,z=u.gb()+0.25,y=Math.random(),A+(z-A)*y)),g=new cV((A=Math.random(),0+(w-0)*A),(A=2*r,z=Math.random(),r+(A-r)*z));dI().color(0.3,0.3,0.3,1).V(0.5,0.3,0.3,1).position(n).pa().h(0.02,0.04).F(0.01,0.2).ja(15).D(2,4).b(g).I(0.05,0.1)}}else{this.Jb=0}if(this.ya){for(this.Lb-=B;this.Lb<0;){this.Lb+=0.025;n=(A=this.Aa.f,z=new cV((x=-0.2,x+(0.2-x)*Math.random()),(x=-0.4,x+(0.4-x)*Math.random())),y=new cV(0,0),y.x=A.x+z.x,y.y=A.y+z.y,y);dI().color(1,1,0,1).V(1,1,0,0.75).position(n).pa().h(0.03,0.05).expand(1.1,1.2).F(0.1,0.2).ja(5).D(2,3)}}else{this.Lb=0}};dq.prototype.Le=function(n){var g,x,w=1;this.zd+=n*Math.abs(this.W.x)*Math.PI;this.Kc+=8*n;if(this.z==3){this.ia=p;n=el}else{if(this.z==4){this.ia=l;n=el}else{if(this.z==1){if(this.W.x<0){this.ia=p}else{if(this.W.x>0){this.ia=l}}if(this.W.y>-15){n=this.W.y/4;n=n<0?1/(1-n)-1:1-1/(1+n);n=0.5-0.5*n;n=d[0].jb(d[1],n)}else{n=cI.Ua(ap,this.Kc)}}else{if(this.z==2){var u={},r={};cN.$a(this,2,u,r,cQ.j);n=(this.a().y-r.c.y)/0.75;n+=0.5;n=dT[0].jb(dT[1],n);this.ia=u.c.x<r.c.x}else{if(this.crouchKey){n=aJ}else{n=cI.Ua(a0,this.zd);if(this.W.x<-0.1){this.ia=p}else{if(this.W.x>0.1){this.ia=l}}w=Math.abs(this.W.x)/5;if(w>1){w=1}}}}}}for(u=0;u<this.d.length;u++){this.d[u].k=n.xa[u]*w}w=(g=n.f,x=new cV(0,0),x.x=g.x*w,x.y=g.y*w,x);this.d[bS].n=new cV(this.a().x+w.x*(this.ia?-1:1),this.a().y+w.y);this.d[bS].bb=!this.ia};dq.prototype.e=function(g){if(!this.l){if(this.ya){g.strokeStyle="rgba(255, 255, 0, "+Math.max(0,this.b.y/10).toFixed(3)+")";g.lineWidth*=3;this.d[bS].e(g);g.lineWidth/=3}g.fillStyle=this.ie()==0?"red":"blue";g.strokeStyle="black";this.d[bS].e(g)}}})();